/*----------------------------------------------------------------------* 
 * Copyright  (c) 2014 SAP SE. All rights reserved	
 * Author       : SAP Custom Development 
 *----------------------------------------------------------------------*/ 
	!function(){"use strict";jQuery.sap.declare({modName:"com.zespri.awct.core.Controller",type:"controller"}),jQuery.sap.require("sap.ui.core.mvc.Controller"),sap.ui.core.mvc.Controller.extend("com.zespri.awct.core.Controller",{bHasUnsavedChanges:!1,getRouter:function(){return sap.ui.getCore().getRootComponent().getRouter()},setHasUnsavedChanges:function(a){this.bHasUnsavedChanges=a,this.handleViewDirtyStateChanged(a)},getHasUnsavedChanges:function(){return this.bHasUnsavedChanges},handleViewDirtyStateChanged:function(){}})}();
!function(){"use strict";jQuery.sap.declare("com.zespri.awct.core.Router"),jQuery.sap.require("sap.ui.core.routing.Router"),sap.ui.core.routing.Router.extend("com.zespri.awct.core.Router",{_mNavToComplexData:{},navBack:function(){var a=this,b=function(){var b=sap.ui.core.routing.History.getInstance(),c=b.getPreviousHash();void 0!==c&&(window.history.go(-1),a.fireNavigationCompleted())};this._validateAndNavigate(b)},navTo:function(){var a=arguments,b=this,c=function(){if(a[1]&&a[1].customData){var c=a[0],d=a[1].customData;b._mNavToComplexData[c]=d,delete a[1].customData}sap.ui.core.routing.Router.prototype.navTo.apply(b,a),b.fireNavigationCompleted()};this._validateAndNavigate(c)},removeViewFromCache:function(a){this._oViews[a]=null},fireRoutePatternMatched:function(a){var b=a.name;return this._mNavToComplexData[b]&&(a.arguments.customData=this._mNavToComplexData[b],delete this._mNavToComplexData[b]),this.fireEvent("routePatternMatched",a),this},_validateAndNavigate:function(a){var b=sap.ui.getCore().getRootComponent().isCurrentViewDirty();return b?void this.fireOnBeforeNavigationWithUnsavedChanges({fnAllowNavigation:a}):void a()},fireOnBeforeNavigationWithUnsavedChanges:function(a){this.fireEvent("onBeforeNavigationWithUnsavedChanges",a)},attachOnBeforeNavigationWithUnsavedChanges:function(a,b,c){this.attachEvent("onBeforeNavigationWithUnsavedChanges",a,b,c)},detachOnBeforeNavigationWithUnsavedChanges:function(a,b){this.detachEvent("onBeforeNavigationWithUnsavedChanges",a,b)},fireNavigationCompleted:function(a){this.fireEvent("navigationCompleted",a)},attachNavigationCompleted:function(a,b,c){this.attachEvent("navigationCompleted",a,b,c)},detachNavigationCompleted:function(a,b){this.detachEvent("navigationCompleted",a,b)}})}();
!function(){"use strict";jQuery.sap.declare("com.zespri.awct.util.Constants"),com.zespri.awct.util.Constants={C_LOGOFF_URL:"/sap/public/bc/icf/logoff",C_REDIRECT_URL_PARAM:"redirectURL=/sap/bc/ui5_ui5/sap/zawct_uia/index.html",C_IS_BROWSER_IE:sap.ui.Device.browser.internet_explorer||!1,C_SEVERITY_ERROR:"error",C_SEVERITY_WARNING:"warning",C_ODATA_MODEL_SIZE_LIMIT:1e4,C_XSRF_TOKEN:"x-csrf-token"}}();
!function(){"use strict";jQuery.sap.declare("com.zespri.awct.util.Enums"),com.zespri.awct.util.Enums={NotificationType:{Error:"ERROR",Warning:"WARNING",Info:"INFO",Success:"SUCCESS",None:"NONE"},ViewBCOperation:{Exclude:"E",Include:"I"},AuthorizationMode:{None:"00",Maintain:"02",Display:"03"},AuthorizationFunctions:{All:"*",ZSUP:"ZSUP",ZESP:"ZESP",ZADM:"ZADM"},AuthorizationObject:{Allocation:"ZAWCT_ALLO",Collaboration:"ZAWCT_COLB",Reports:"ZAWCT_REPS",Administration:"ZAWCT_ADMN"},AllocationLineRecordType:{DeliveryLine:"D",SupplierOrderLine:"A"},ExemptionStatus:{NONE:"",PENDING:"P",COMPLETE:"C"},TradeType:{Inbound:"I",Outbound:"O",Open:"OP"},TradeStatus:{Initiated:"I",Accepted:"A",Rejected:"R",Expired:"E",PartiallyAccepted:"P",Cancelled:"C"},DeliveryStatus:{NotStarted:"E0001",InProgress:"E0002",Released:"E0003",Locked:"E0004"},ViewMode:{Add:"Add",Modify:"Edit"}}}();
!function(){"use strict";jQuery.sap.declare("com.zespri.awct.util.ModelHelper"),com.zespri.awct.util.ModelHelper={},com.zespri.awct.util.ModelHelper.getJSONModelForRead=function(a,b,c,d){jQuery.sap.assert(null!=c,"Parameter fnSuccess is mandatory, but wasn't provided."),jQuery.sap.assert("function"==typeof c,"Parameter fnSuccess should be a function, but isn't.");var e=function(a){var b={},d=new sap.ui.model.json.JSONModel;a.results?(b=a,d.setSizeLimit(a.results.length)):b.result=a,d.setData(b),c(d)},f=function(a){d&&"function"==typeof d&&d(a)},g={};b&&(b.context&&(g.context=b.context),b.urlParameters&&(g.urlParameters=b.urlParameters)),g.success=e,g.error=f,sap.ui.getCore().getRootComponent().getModel().read(a,g)}}();
!function(){"use strict";jQuery.sap.declare("com.zespri.awct.util.CommonHelper"),jQuery.sap.require("com.zespri.awct.util.Constants"),jQuery.sap.require("com.zespri.awct.util.ModelHelper"),com.zespri.awct.util.CommonHelper={},com.zespri.awct.util.CommonHelper.getCSRFToken=function(){var a="";try{a=sap.ui.getCore().getRootComponent().getModel().oServiceData.securityToken}catch(b){a=""}return 0===a.length&&(sap.ui.getCore().getRootComponent().getModel().refreshSecurityToken(),a=sap.ui.getCore().getRootComponent().getModel().oServiceData.securityToken),a},com.zespri.awct.util.CommonHelper.getLogoffURL=function(){return com.zespri.awct.util.Constants.C_LOGOFF_URL+"?"+com.zespri.awct.util.Constants.C_REDIRECT_URL_PARAM},com.zespri.awct.util.CommonHelper.isUserAuthorized=function(a,b,c){if(sap.ui.getCore().getRootComponent().getModel("currentUserDetails")){var d=sap.ui.getCore().getRootComponent().getModel("currentUserDetails").getData().AuthorizationSet,e=!1;if(!b||a&&c){if(!a||!b||!c||a===com.zespri.awct.util.Enums.AuthorizationMode.None)return!1;$.each(d,function(d,f){var g=f.AuthorizationObject.toLowerCase();if(g===com.zespri.awct.util.Enums.AuthorizationFunctions.All||g===b.toLowerCase()){var h=f.Function.toLowerCase();if(h===com.zespri.awct.util.Enums.AuthorizationFunctions.All||h===c.toLowerCase()){var i=f.Mode.toLowerCase();if(i===com.zespri.awct.util.Enums.AuthorizationFunctions.All||i===a.toLowerCase()||i===com.zespri.awct.util.Enums.AuthorizationMode.Maintain)return void(e=!0)}}})}else $.each(d,function(a,c){var d=c.AuthorizationObject.toLowerCase();d===b.toLowerCase()&&(e=!0)});return e}},com.zespri.awct.util.CommonHelper.manageFacetFilterState=function(a,b){this._mFacetFilterStates||(this._mFacetFilterStates={});var c=this;b.setEnabled(!1),a.attachEvent("updateStarted",function(){b.setEnabled(!1),c._mFacetFilterStates[b.getId()]?c._mFacetFilterStates[b.getId()].push(a):c._mFacetFilterStates[b.getId()]=[a]}),a.attachEvent("updateFinished",function(){if(1===c._mFacetFilterStates[b.getId()].length)delete c._mFacetFilterStates[b.getId()],b.setEnabled(!0);else{var d=c._mFacetFilterStates[b.getId()].indexOf(a);d>-1&&c._mFacetFilterStates[b.getId()].splice(d,1)}})},com.zespri.awct.util.CommonHelper.manageNoDataText=function(a){jQuery.sap.require("com.zespri.awct.control.FacetFilterList"),(a.getBinding("items")||a instanceof sap.m.Table)&&(a.setBusyIndicatorDelay(0),a.setBusy(!0));var b=com.zespri.awct.util.I18NHelper.getText("TXT_LIST_LOADING_LABEL");a.setNoDataText(b),a.attachEvent("updateStarted",function(){a instanceof com.zespri.awct.control.FacetFilterList||a.setBusy(!0),a.setNoDataText(b)}),a.attachEvent("updateFinished",function(b){if(!a.getCustomData()||!a.getCustomData()[0]||"loadingData"!==a.getCustomData()[0].getKey()||a.getCustomData()[0].getValue()!==!0){var c=b.getParameter("actual"),d=a.getBinding("items").aFilters.length>0||a.getBinding("items").aApplicationFilters.length>0;if(0!==c||d){if(0===c&&d){var e=com.zespri.awct.util.I18NHelper.getText("TXT_LIST_NO_MATCHING_ITEMS_LABEL");a.setNoDataText(e)}}else{var f=com.zespri.awct.util.I18NHelper.getText("TXT_LIST_NO_ITEMS_LABEL");a.setNoDataText(f)}a.setBusy(!1)}})},com.zespri.awct.util.CommonHelper.createFacetFilterListItems=function(a,b){var c=a.facetListControl,d="/"+a.entitySetName,e=a.filterString,f=a.selectString;if(!c.getBinding("items")||b){c.setBusy(!0);var g=function(a){c.setModel(a),c.bindItems({path:"/results",template:c.getBindingInfo("items")?c.getBindingInfo("items").template:c.getItems()[0].clone()}),c.setBusy(!1)},h=function(a){com.zespri.awct.util.NotificationHelper.handleErrorMessage(a),c.setBusy(!1)},i={};i=e&&f?{$filter:e,$select:f}:e&&!f?{$filter:e}:!e&&f?{$select:f}:a.urlParameter?a.urlParameter:{},com.zespri.awct.util.ModelHelper.getJSONModelForRead(d,{urlParameters:i},g,h)}else c.setBusy(!1)}}();
!function(){"use strict";jQuery.sap.declare("com.zespri.awct.util.TableRowActionsExtension"),sap.ui.base.ManagedObject.extend("com.zespri.awct.util.TableRowActionsExtension",{metadata:{associations:{table:{type:"sap.m.Table"}},aggregations:{actionsContent:{multiple:!1,type:"sap.ui.core.Control"}},events:{onBeforeActionsVisible:{}}},_$activeRow:null,_bDeactivating:null,_$queuedRow:null,_oQueuedContext:null,showRowActions:function(a){var b=this._getRowDomRefByContext(a);if(b){this._bDeactivating?(this._$queuedRow=b,this._oQueuedContext=a):this._activateRow(b,a);var c=jQuery.device.is.tablet||jQuery.device.is.phone?"touchend":"mouseup";$(document).on(c,jQuery.proxy(this._handleOutsideClick,this))}},hideRowActions:function(){this._$activeRow&&this._deactivateRow(this._$activeRow)},_handleOutsideClick:function(){if(!$(event.target).closest(".zAwctTableRowActions").length){var a=jQuery.device.is.tablet||jQuery.device.is.phone?"touchend":"mouseup";$(document).off(a,jQuery.proxy(this._handleOutsideClick,this)),this._deactivateRow(this._$activeRow)}},_handleWindowResize:function(){var a=this._$activeRow.height(),b=this._$activeRow.position().top,c=$(".zAwctTableRowActions");c.css("height",a),c.css("top",b)},_deactivateRow:function(a){this._bDeactivating=!0;var b=this;a.animate({opacity:1},"fast");var c=$(".zAwctTableRowActions"),d=-1*c.width();c.animate({right:d},"fast",function(){b._bDeactivating=!1,c.hide(),$(window).off("resize",jQuery.proxy(this._handleWindowResize,this)),b._$queuedRow&&(b._activateRow(b._$queuedRow,b._oQueuedContext),b._$queuedRow=null,b._oQueuedContext=null)})},_activateRow:function(a,b){var c=this.getActionsContent();c.setBindingContext(null),c.setBindingContext(b);var d=this.fireOnBeforeActionsVisible({actionsContent:c,rowContext:b},!0);if(d){$(".zAwctTableRowActions").parent()[0]!==sap.ui.getCore().byId(this.getTable()).$()[0]&&$(".zAwctTableRowActions").remove(),$(".zAwctTableRowActions").length||sap.ui.getCore().byId(this.getTable()).$().append("<div class='zAwctTableRowActions'/>");var e=$(".zAwctTableRowActions"),f=a.position().top,g=a.height(),h=this.getActionsContent(),i=sap.ui.getCore().createRenderManager();i.renderControl(h),i.flush(e.get(0),!0),e.css("top",f),e.css("right",-1*e.width()),e.css("height",g),a.animate({opacity:.3},"fast"),this._$activeRow=a,e.show(),e.animate({right:0},"fast"),$(window).on("resize",jQuery.proxy(this._handleWindowResize,this))}},getUIArea:function(){return null},_getRowDomRefByContext:function(a){var b=sap.ui.getCore().byId(this.getAssociation("table")),c=b.$().find("tr:not(.sapMListTblHeader)"),d=null;return $.each(c,function(b,c){var e=$(c),f=sap.ui.getCore().byId(e.find(".sapMText:first").attr("id"));if(!f)return!0;var g=f.getBindingContext();return g.getPath()===a.getPath()?(d=e,!1):void 0}),d}})}();
!function(){"use strict";jQuery.sap.declare("com.zespri.awct.util.I18NHelper"),com.zespri.awct.util.I18NHelper={},com.zespri.awct.util.I18NHelper.getText=function(a,b){return sap.ui.getCore().getRootComponent().getModel("i18n").ResourceBundle.getText(a,b)}}();
!function(){"use strict";jQuery.sap.declare("com.zespri.awct.util.NotificationHelper"),jQuery.sap.require("com.zespri.awct.util.Constants"),jQuery.sap.require("com.zespri.awct.util.Enums"),jQuery.sap.require("com.zespri.awct.util.I18NHelper"),jQuery.sap.require("sap.m.MessageToast"),com.zespri.awct.util.NotificationHelper={showErrorToast:function(a){var b=new Error;sap.m.MessageToast.show(a),jQuery.sap.log.error("Error shown to user : "+a+"\n -- STACK TRACE --"+b.stack)},showErrorDialog:function(a,b){var c={};c.message=a,c.type=com.zespri.awct.util.Enums.NotificationType.None,this._showDialog(c,b)},showSuccessToast:function(a){sap.m.MessageToast.show(a),jQuery.sap.log.info("Success message shown to user : "+a)},showConfirmDialog:function(a,b,c){var d=function(){f.close(),b&&"function"==typeof b&&b()},e=function(){f.close(),c&&"function"==typeof c&&c()},f=new sap.m.Dialog({title:com.zespri.awct.util.I18NHelper.getText("TXT_SHELL_CONFIRM_DIALOG_TITLE"),type:sap.m.DialogType.Message,icon:"sap-icon://error",content:new sap.m.Text({text:a}),beginButton:new sap.m.Button({text:com.zespri.awct.util.I18NHelper.getText("TXT_GENERIC_OK"),press:[d,this]}),endButton:new sap.m.Button({text:com.zespri.awct.util.I18NHelper.getText("TXT_GENERIC_CANCEL"),press:[e,this]})});f.open()},handleErrorMessage:function(a,b,c){if(0||(c=!0),a instanceof Array&&(a=a[0]),null!==(a||null)&&null!==(a.response||null)){try{var d=parseInt(a.response.statusCode,10);switch(d){case 202:case 400:case 401:case 403:case 500:var e=this._transformErrorResponse(a.response);return c&&e&&this._showDialog(e),!0}}catch(f){jQuery.sap.log.warning("Handle Error Message failed",f.message,"com.zespri.awct.util.MessageHandler.handleMessage")}return!1}},_transformErrorResponse:function(a){var b=null,c=null;try{c=JSON.parse(a.body)}catch(d){c=null}return null!==c&&(b={type:com.zespri.awct.util.Enums.NotificationType.None,message:"",innerTable:[]},b.message=c.error.message.value,c.error.innererror.errordetails&&c.error.innererror.errordetails.length>0&&$.each(c.error.innererror.errordetails,function(a,c){var d={};d.severity=c.severity,d.message=c.message,b.innerTable.push(d),b.type!==com.zespri.awct.util.Enums.NotificationType.Error&&(c.severity===com.zespri.awct.util.Constants.C_SEVERITY_ERROR?b.type=com.zespri.awct.util.Enums.NotificationType.Error:b.type!==com.zespri.awct.util.Enums.NotificationType.Warning&&c.severity===com.zespri.awct.util.Constants.C_SEVERITY_WARNING&&(b.type=com.zespri.awct.util.Enums.NotificationType.Warning))})),b},_showDialog:function(a,b){var c="",d="",e=new sap.m.Text,f=null,g=sap.ui.core.ValueState.None;if(a.message.length<=0)this.showErrorToast(com.zespri.awct.util.I18NHelper.getText("TXT_NOTIFICATION_GENERIC_ERROR"));else{switch(jQuery.sap.require("sap.m.Dialog"),e.setText(a.message),f=new sap.m.Button({text:com.zespri.awct.util.I18NHelper.getText("TXT_GENERIC_CLOSE"),visible:!0,press:function(a){var c=a.getSource().getParent();c.close(),c.destroy(),b&&"function"==typeof b&&b()}}),a.type){case com.zespri.awct.util.Enums.NotificationType.Error:c=com.zespri.awct.util.I18NHelper.getText("TXT_NOTIFICATION_ERROR_HEAD"),g=sap.ui.core.ValueState.Error,d="sap-icon://error";break;case com.zespri.awct.util.Enums.NotificationType.Warning:c=com.zespri.awct.util.I18NHelper.getText("TXT_NOTIFICATION_WARNING_HEAD"),g=sap.ui.core.ValueState.Warning,d="sap-icon://warning2";break;default:c=com.zespri.awct.util.I18NHelper.getText("TXT_NOTIFICATION_DEFAULT_HEAD"),g=sap.ui.core.ValueState.None,d="sap-icon://notification"}var h=new sap.m.Dialog({state:g,title:c,type:sap.m.DialogType.Message,icon:d});h.addContent(e),h.setAggregation("endButton",f),h.open()}}}}();
!function(){"use strict";jQuery.sap.declare("com.zespri.awct.util.CommonFormatHelper"),com.zespri.awct.util.CommonFormatHelper={},com.zespri.awct.util.CommonFormatHelper.formatQuantityAsInteger=function(a){if(a){var b=parseInt(a,10);return b}return""},com.zespri.awct.util.CommonFormatHelper.formatQuantityWithDecimals=function(a){if(null!==a&&void 0!==a){var b=sap.ui.core.format.NumberFormat.getIntegerInstance({maxFractionDigits:2,minFractionDigits:2,groupingEnabled:!0},new sap.ui.core.Locale("en-NZ"));return b.format(a)}return""},com.zespri.awct.util.CommonFormatHelper.formatUserName=function(a,b){return null==a&&(a=""),null==b&&(b=""),a+" "+b},com.zespri.awct.util.CommonFormatHelper.formatJSDateToEDMDateTimeString=function(a,b){if(a){var c=new Date(a.valueOf()),d=c.getTimezoneOffset();c.setMinutes(c.getMinutes()+d);var e=c.getFullYear(),f=c.getMonth()+1,g=f>9?f:"0"+f,h=c.getDate(),i=h>9?h:"0"+h,j=c.getHours(),k=j>9?j:"0"+j,l=c.getMinutes(),m=l>9?l:"0"+l,n=c.getSeconds(),o=n>9?n:"0"+n,p=e+"-"+g+"-"+i+"T"+k+":"+m+":"+o;return b?p:"datetime'"+p+"'"}return""}}();
!function(){"use strict";jQuery.sap.declare("com.zespri.awct.util.LocaleFormatHelper"),jQuery.sap.require("sap.ui.core.format.DateFormat"),jQuery.sap.require("sap.ui.core.format.NumberFormat"),com.zespri.awct.util.LocaleFormatHelper={},com.zespri.awct.util.LocaleFormatHelper.formatDateObject=function(a){if(a){var b=sap.ui.core.format.DateFormat.getDateInstance(new sap.ui.core.Locale("en-NZ")),c=b.format(a,!1);return c}return""},com.zespri.awct.util.LocaleFormatHelper.formatDateTimeObject=function(a){if(a){var b=sap.ui.core.format.DateFormat.getDateTimeInstance(new sap.ui.core.Locale("en-NZ")),c=b.format(a,!1);return c}return""},com.zespri.awct.util.LocaleFormatHelper.formatQuantity=function(a){if(null!==a&&void 0!==a){var b=sap.ui.core.format.NumberFormat.getIntegerInstance({maxFractionDigits:0,groupingEnabled:!0},new sap.ui.core.Locale("en-NZ"));return b.format(a)}return""},com.zespri.awct.util.LocaleFormatHelper.formatAmount=function(a,b){a||(a=0);var c=sap.ui.core.format.NumberFormat.getFloatInstance({minFractionDigits:2,maxFractionDigits:2,groupingEnabled:!0},new sap.ui.core.Locale("en-NZ"));return c.format(a)+" "+b}}();
!function(){jQuery.sap.declare("com.zespri.awct.control.FileUploaderParameter"),jQuery.sap.require("sap.ui.core.Element"),sap.ui.core.Element.extend("com.zespri.awct.control.FileUploaderParameter",{metadata:{properties:{name:{type:"string",group:"Data",defaultValue:null},value:{type:"string",group:"Data",defaultValue:null}}}})}();
!function(){jQuery.sap.declare("com.zespri.awct.control.FileUploaderRenderer"),com.zespri.awct.control.FileUploaderRenderer=function(){},com.zespri.awct.control.FileUploaderRenderer.render=function(a,b){var c=a,d=sap.ui.getCore().getConfiguration().getAccessibility();if(b.getVisible()){c.write("<div"),c.writeControlData(b),c.addClass("sapUiFup"),c.writeClasses(),c.write(">"),c.write('<form style="display:inline-block" encType="multipart/form-data" method="post"'),c.writeAttribute("id",b.getId()+"-fu_form"),com.zespri.awct.util.Constants.C_IS_BROWSER_IE&&sap.ui.Device.browser.version<=9?c.writeAttributeEscaped("action",b.getUploadUrlX()+"?action=upload_csv"):c.writeAttributeEscaped("action",b.getUploadUrl()),c.writeAttribute("target",b.getId()+"-frame"),c.write(">"),c.write('<div class="sapUiFupInp"'),d&&(c.writeAttribute("role","textbox"),c.writeAttribute("aria-readonly","true")),c.write(">"),com.zespri.awct.util.Constants.C_IS_BROWSER_IE&&sap.ui.Device.browser.version<=9||(c.write(b.getButtonOnly()?'<div class="sapUiFupGroup" border="0" cellPadding="0" cellSpacing="0"><div><div style="display:none">':'<div class="sapUiFupGroup" border="0" cellPadding="0" cellSpacing="0"><div><div>'),c.renderControl(b.oFilePath),c.write("</div><div>"),c.renderControl(b.oBrowse),c.write("</div></div></div>"));var e=b.getName()||b.getId();c.write(com.zespri.awct.util.Constants.C_IS_BROWSER_IE&&sap.ui.Device.browser.version<=9?'<div class="zAwctDisplayIEUpload">':'<div class="zAwctDisplayIEUpload" style="display:none">'),c.write('<input type="hidden" id="slug"'),c.writeAttributeEscaped("name","slug"),c.writeAttributeEscaped("value",""),c.write(">"),c.write('<input type="hidden" id="'+com.zespri.awct.util.Constants.C_XSRF_TOKEN+'"'),c.writeAttributeEscaped("name",com.zespri.awct.util.Constants.C_XSRF_TOKEN),c.writeAttributeEscaped("value",com.zespri.awct.util.CommonHelper.getCSRFToken()||""),c.write(">"),c.write('<input type="hidden" name="_charset_">'),c.write('<input type="hidden" id="'+b.getId()+'-fu_data"'),c.writeAttributeEscaped("name",e+"-data"),c.writeAttributeEscaped("value",b.getAdditionalData()||""),c.write(">"),jQuery.each(b.getParameters(),function(a,b){c.write('<input type="hidden" '),c.writeAttributeEscaped("name",b.getName()||""),c.writeAttributeEscaped("value",b.getValue()||""),c.write(">")}),c.write("</div>"),c.write("</div>"),c.write("</form>"),c.write("</div>")}}}();
!function(){"use strict";jQuery.sap.declare("com.zespri.awct.control.FileUploader"),jQuery.sap.declare("com.zespri.awct.util.Constants"),jQuery.sap.require("com.zespri.awct.util.I18NHelper"),jQuery.sap.require("com.zespri.awct.util.CommonHelper"),jQuery.sap.require("sap.ui.core.Control"),sap.ui.core.Control.extend("com.zespri.awct.control.FileUploader",{metadata:{publicMethods:["upload","abort"],properties:{value:{type:"string",group:"Data",defaultValue:""},enabled:{type:"boolean",group:"Behavior",defaultValue:!0},visible:{type:"boolean",group:"Behavior",defaultValue:!0},uploadUrl:{type:"sap.ui.core.URI",group:"Data",defaultValue:""},uploadUrlX:{type:"sap.ui.core.URI",group:"Data",defaultValue:""},name:{type:"string",group:"Data",defaultValue:null},width:{type:"sap.ui.core.CSSSize",group:"Misc",defaultValue:""},uploadOnChange:{type:"boolean",group:"Behavior",defaultValue:!1},additionalData:{type:"string",group:"Data",defaultValue:null},sameFilenameAllowed:{type:"boolean",group:"Behavior",defaultValue:!1},buttonText:{type:"string",group:"Misc",defaultValue:null},fileType:{type:"string[]",group:"Data",defaultValue:null},multiple:{type:"boolean",group:"Behavior",defaultValue:!1},maximumFileSize:{type:"float",group:"Data",defaultValue:null},mimeType:{type:"string[]",group:"Data",defaultValue:null},sendXHR:{type:"boolean",group:"Behavior",defaultValue:!1},placeholder:{type:"string",group:"Appearance",defaultValue:null},style:{type:"string",group:"Appearance",defaultValue:null},buttonOnly:{type:"boolean",group:"Appearance",defaultValue:!1},useMultipart:{type:"boolean",group:"Behavior",defaultValue:!0},maximumFilenameLength:{type:"int",group:"Data",defaultValue:null},valueState:{type:"sap.ui.core.ValueState",group:"Data",defaultValue:sap.ui.core.ValueState.None}},aggregations:{parameters:{type:"com.zespri.awct.control.FileUploaderParameter",multiple:!0,singularName:"parameter"},headerParameters:{type:"com.zespri.awct.control.FileUploaderParameter",multiple:!0,singularName:"headerParameter"}},events:{change:{},uploadComplete:{},typeMissmatch:{},fileSizeExceed:{},fileAllowed:{},uploadProgress:{},uploadAborted:{},filenameLengthExceed:{}},renderer:"com.zespri.awct.control.FileUploaderRenderer"}}),com.zespri.awct.control.FileUploader.M_EVENTS={change:"change",uploadComplete:"uploadComplete",typeMissmatch:"typeMissmatch",fileSizeExceed:"fileSizeExceed",fileAllowed:"fileAllowed",uploadProgress:"uploadProgress",uploadAborted:"uploadAborted",filenameLengthExceed:"filenameLengthExceed"},com.zespri.awct.control.FileUploader.prototype.init=function(){com.zespri.awct.util.Constants.C_IS_BROWSER_IE&&8===sap.ui.Device.browser.version?(this.oFilePath=new sap.ui.commons.TextField(this.getId()+"-fu_input",{width:"225px"}),this.oBrowse=new sap.ui.commons.Button({enabled:this.getEnabled(),text:"Browse..",width:"0px",height:"0px"})):(this.oFilePath=com.zespri.awct.control.FileUploaderHelper.createTextField(this.getId()+"-fu_input"),this.oBrowse=com.zespri.awct.control.FileUploaderHelper.createButton()),this.oFilePath.setParent(this),this.oBrowse.setParent(this),this.oFileUpload=null,this.oBrowse.setText(this.getBrowseText());var a=this;this.oBrowse.attachPress(function(){var b=jQuery.sap.byId(a.getId()+"-fu");b.trigger("click")})},com.zespri.awct.control.FileUploader.prototype.setButtonText=function(a){return this.oBrowse.setText(a||this.getBrowseText()),this.setProperty("buttonText",a,!1),this},com.zespri.awct.control.FileUploader.prototype.getIdForLabel=function(){return this.oBrowse.getId()},com.zespri.awct.control.FileUploader.prototype.setFileType=function(a){var b=this._convertTypesToArray(a);return this.setProperty("fileType",b,!1),this},com.zespri.awct.control.FileUploader.prototype.setMimeType=function(a){var b=this._convertTypesToArray(a);return this.setProperty("mimeType",b,!1),this},com.zespri.awct.control.FileUploader.prototype._convertTypesToArray=function(a){return"string"==typeof a?""===a?[]:a.split(","):a},com.zespri.awct.control.FileUploader.prototype.exit=function(){this.oFilePath.destroy(),this.oBrowse.destroy(),this.oIFrameRef&&(jQuery(this.oIFrameRef).unbind(),sap.ui.getCore().getStaticAreaRef().removeChild(this.oIFrameRef),this.oIFrameRef=null)},com.zespri.awct.control.FileUploader.prototype.onBeforeRendering=function(){var a=sap.ui.getCore().getStaticAreaRef();jQuery(this.oFileUpload).appendTo(a),jQuery(this.oFileUpload).unbind()},com.zespri.awct.control.FileUploader.prototype.onAfterRendering=function(){this.prepareFileUploadAndIFrame(),jQuery(this.oFileUpload).change(jQuery.proxy(this.handlechange,this)),com.zespri.awct.util.Constants.C_IS_BROWSER_IE&&sap.ui.Device.browser.version<=8?(this.oBrowse.getDomRef().style.padding="0px",this.oBrowse.getDomRef().style.visibility="hidden",this.oFilePath.getDomRef().style.height="20px",this.oFilePath.getDomRef().style.visibility="hidden",jQuery(this.oFilePath.getDomRef()).removeClass("sapUiTfBrd")):(this.oFilePath.$().attr("tabindex","-1"),com.zespri.awct.util.Constants.C_IS_BROWSER_IE&&9===sap.ui.Device.browser.version&&this.oBrowse.$().attr("tabindex","-1"),jQuery.sap.delayedCall(0,this,this._recalculateWidth))},com.zespri.awct.control.FileUploader.prototype._recalculateWidth=function(){this.getWidth()&&(this.getButtonOnly()?this.oBrowse.getDomRef().style.width=this.getWidth():this._resizeDomElements())},com.zespri.awct.control.FileUploader.prototype.getFocusDomRef=function(){return this.$("fu").get(0)},com.zespri.awct.control.FileUploader.prototype._resizeDomElements=function(){var a=this.getId();this._oBrowseDomRef=this.oBrowse.getDomRef();var b=jQuery(this._oBrowseDomRef),c=b.parent().outerWidth(!0);this._oFilePathDomRef=this.oFilePath.getDomRef();var d=this._oFilePathDomRef,e=this.getWidth();if("%"===e.substr(-1)){for(;d.id!==a;)d.style.width="100%",d=d.parentNode;d.style.width=e}else{d.style.width=e;var f=jQuery(this._oFilePathDomRef),g=f.outerWidth()-c;0>g?(this.oFilePath.getDomRef().style.width="0px",com.zespri.awct.util.Constants.C_IS_BROWSER_IE||(this.oFileUpload.style.width=b.outerWidth(!0))):this.oFilePath.getDomRef().style.width=g+"px"}},com.zespri.awct.control.FileUploader.prototype.onresize=function(){this._recalculateWidth()},com.zespri.awct.control.FileUploader.prototype.onThemeChanged=function(){this._recalculateWidth()},com.zespri.awct.control.FileUploader.prototype.setEnabled=function(a){return this.setProperty("enabled",a,!0),this.oFilePath.setEnabled(a),this.oBrowse.setEnabled(a),a?this.$("fu").removeAttr("disabled"):this.$("fu").attr("disabled","disabled"),this},com.zespri.awct.control.FileUploader.prototype.setValueState=function(a){return this.setProperty("valueState",a),this.oFilePath.setValueState&&this.oFilePath.setValueState(a),this},com.zespri.awct.control.FileUploader.prototype.setUploadUrl=function(a){this.setProperty("uploadUrl",a,!0);var b=this.$("fu_form");return b.attr("action",this.getUploadUrl()),this},com.zespri.awct.control.FileUploader.prototype.setPlaceholder=function(a){return this.setProperty("placeholder",a,!0),this.oFilePath.setPlaceholder(a),this},com.zespri.awct.control.FileUploader.prototype.setStyle=function(a){return this.setProperty("style",a,!0),"Transparent"===a?this.oBrowse.setLite?this.oBrowse.setLite(!0):this.oBrowse.setType("Transparent"):this.oBrowse.setType?this.oBrowse.setType(a):("Emphasized"===a&&(a="Emph"),this.oBrowse.setStyle(a)),this},com.zespri.awct.control.FileUploader.prototype.setValue=function(a,b){var c=this.getValue();if(c!==a||this.getSameFilenameAllowed()){var d=this.getUploadOnChange()&&a;this.setProperty("value",a,d),this.oFilePath&&(this.oFilePath.setValue(a),com.zespri.awct.util.Constants.C_IS_BROWSER_IE&&8===sap.ui.Device.browser.version||!this.oFilePath.getFocusDomRef()||this.oFilePath.getFocusDomRef().focus());var e=this.getDomRef("fu_form");this.oFileUpload&&e&&!a&&(e.reset(),sap.ui.Device.browser.chrome&&(this.getDomRef("fu_input").value=""),this.$("fu_data").val(this.getAdditionalData())),b&&this.fireChange({id:this.getId(),newValue:a}),d&&this.upload()}return this},com.zespri.awct.control.FileUploader.prototype.onmouseover=function(){jQuery(this.oBrowse.getDomRef()).addClass("sapUiBtnStdHover")},com.zespri.awct.control.FileUploader.prototype.onmouseout=function(){jQuery(this.oBrowse.getDomRef()).removeClass("sapUiBtnStdHover")},com.zespri.awct.control.FileUploader.prototype.onfocusin=function(){jQuery(this.oBrowse.getDomRef()).addClass("sapUiBtnStdHover")},com.zespri.awct.control.FileUploader.prototype.onfocusout=function(){jQuery(this.oBrowse.getDomRef()).removeClass("sapUiBtnStdHover")},com.zespri.awct.control.FileUploader.prototype.setAdditionalData=function(a){this.setProperty("additionalData",a,!0);var b=this.getDomRef("fu_data");if(b){var c=this.getAdditionalData()||"";b.value=c}return this},com.zespri.awct.control.FileUploader.prototype.upload=function(){var a=this.getDomRef("fu_form"),b=this,c;try{if(a){this._bUploading=!0;var d,e,f,g;if(this.getSendXHR()&&window.File){var h=jQuery.sap.domById(this.getId()+"-fu").files;if(h.length>0){var i=this._uploadXHR=new window.XMLHttpRequest;if(i.upload.addEventListener("progress",function(a){var c={lengthComputable:!!a.lengthComputable,loaded:a.loaded,total:a.total};b.fireUploadProgress(c)}),i.upload.addEventListener("abort",function(){b.fireUploadAborted()}),i.open("POST",this.getUploadUrl(),!0),i.setRequestHeader(com.zespri.awct.util.Constants.C_XSRF_TOKEN,com.zespri.awct.util.CommonHelper.getCSRFToken()),this.getHeaderParameters())for(d=this.getHeaderParameters(),e=0;e<d.length;e++)f=d[e].getName(),g=d[e].getValue(),i.setRequestHeader(f,g);if(this.getUseMultipart()){c=new window.FormData;for(var j=jQuery.sap.domById(this.getId()+"-fu").name,k=0;k<h.length;k++)c.append(j,h[k]);c.append("_charset_","UTF-8");var l=jQuery.sap.domById(this.getId()+"-fu_data").name;if(this.getAdditionalData()){var m=this.getAdditionalData();c.append(l,m)}else c.append(l,"");if(this.getParameters())for(var n=this.getParameters(),o=0;o<n.length;o++){var p=n[o].getName(),q=n[o].getValue();c.append(p,q)}i.send(c)}else c=new window.FormData,c.append(com.zespri.awct.util.Constants.C_XSRF_TOKEN,com.zespri.awct.util.CommonHelper.getCSRFToken()),c.append("file",h[0]),i.send(h[0]);i.onreadystatechange=function(){var a,c,d={},e,f,g,h=i.readyState,j=i.status;if(4===i.readyState){if(i.responseXML&&(a=i.responseXML.documentElement.textContent),c=i.response,e=i.getAllResponseHeaders()){f=e.split("\r\n");for(var k=0;k<f.length;k++)f[k]&&(g=f[k].indexOf(": "),d[f[k].substring(0,g)]=f[k].substring(g+2))}b.fireUploadComplete({headers:d,response:a,responseRaw:c,readyStateXHR:h,status:j})}b._bUploading=!1},this._bUploading=!1}}else{if(this.getHeaderParameters())for(d=this.getHeaderParameters(),e=0;e<d.length;e++)f=d[e].getName(),g=d[e].getValue(),$(a).find("#"+f).val(g);a.submit()}jQuery.sap.log.info("File uploading to "+this.getUploadUrl()),this.getSameFilenameAllowed()&&this.getUploadOnChange()&&this.setValue("",!0)}}catch(r){jQuery.sap.log.error("File upload failed:\n"+r.message)}},com.zespri.awct.control.FileUploader.prototype.abort=function(){this._uploadXHR&&this._uploadXHR.abort&&this._uploadXHR.abort()},com.zespri.awct.control.FileUploader.prototype.onkeypress=function(a){this.onkeydown(a)},com.zespri.awct.control.FileUploader.prototype.onclick=function(){this.getSameFilenameAllowed()&&this.setValue("",!0)},com.zespri.awct.control.FileUploader.prototype.onkeydown=function(a){if(this.getEnabled()){this.getSameFilenameAllowed()&&this.setValue("",!0);var b=a.keyCode,c=jQuery.sap.KeyCodes;b===c.DELETE||b===c.BACKSPACE?this.oFileUpload&&this.setValue("",!0):b===c.SPACE||b===c.ENTER?com.zespri.awct.util.Constants.C_IS_BROWSER_IE&&sap.ui.Device.browser.version<=9||!this.oFileUpload||(this.oFileUpload.click(),a.preventDefault(),a.stopPropagation()):b!==c.TAB&&b!==c.SHIFT&&b!==c.F6&&(a.preventDefault(),a.stopPropagation())}},com.zespri.awct.control.FileUploader.prototype._isFilenameTooLong=function(a){var b=this.getMaximumFilenameLength();return 0!==b&&a.length>b?(jQuery.sap.log.info("The filename of "+a+" ("+a.length+" characters)  is longer than the maximum of "+b+" characters."),!0):!1},com.zespri.awct.control.FileUploader.prototype.handlechange=function(a){if(this.oFileUpload&&this.getEnabled()){var b=this.getMaximumFileSize(),c=this.getFileType(),d=this.getMimeType(),e="";if(window.File){for(var f=a.target.files,g=0;g<f.length;g++){var h=f[g].name,i=f[g].type;i||(i="unknown");var j=f[g].size/1024/1024;if(b&&j>b)return jQuery.sap.log.info("File: "+h+" is of size "+j+" MB which exceeds the file size limit of "+b+" MB."),void this.fireFileSizeExceed({fileName:h,fileSize:j});if(this._isFilenameTooLong(h))return void this.fireFilenameLengthExceed({fileName:h});if(d&&d.length>0){for(var k=!0,l=0;l<d.length;l++)i.match(d[l])&&(k=!1);if(k)return jQuery.sap.log.info("File: "+h+" is of type "+i+". Allowed types are: "+d+"."),void this.fireTypeMissmatch({fileName:h,mimeType:i})}if(c&&c.length>0){for(var m=!0,n=h.lastIndexOf("."),o=h.substring(n+1),p=0;p<c.length;p++)o===c[p]&&(m=!1);if(m)return jQuery.sap.log.info("File: "+h+" is of type "+o+". Allowed types are: "+c+"."),void this.fireTypeMissmatch({fileName:h,fileType:o})}e=e+'"'+f[g].name+'" '}e&&this.fireFileAllowed()}else if(c&&c.length>0){for(var q=!0,r=this.oFileUpload.value||"",s=r.lastIndexOf("."),t=r.substring(s+1),u=0;u<c.length;u++)t===c[u]&&(q=!1);if(q)return jQuery.sap.log.info("File: "+r+" is of type "+t+". Allowed types are: "+c+"."),void this.fireTypeMissmatch({fileName:r,fileType:t});if(this._isFilenameTooLong(r))return void this.fireFilenameLengthExceed({fileName:r});r&&this.fireFileAllowed()}var v=this.oFileUpload.value||"",w=v.lastIndexOf("\\");w>=0&&(v=v.substring(w+1)),this.getMultiple()&&!com.zespri.awct.util.Constants.C_IS_BROWSER_IE&&(v=e),(v||sap.ui.Device.browser.chrome)&&this.setValue(v,!0)}},com.zespri.awct.control.FileUploader.prototype.getBrowseText=function(){return com.zespri.awct.util.I18NHelper.getText("TXT_FILE_UPLOADER_BROWSE")},com.zespri.awct.control.FileUploader.prototype.getShortenValue=function(){return this.getValue()},com.zespri.awct.control.FileUploader.prototype.prepareFileUploadAndIFrame=function(){if(this.oFileUpload)jQuery(this.oFileUpload).prependTo(this.$().find(".zAwctDisplayIEUpload"));else{var a=[];a.push("<input "),a.push('type="file" '),a.push(this.getName()?this.getMultiple()&&!com.zespri.awct.util.Constants.C_IS_BROWSER_IE?'name="'+this.getName()+'[]" ':'name="'+this.getName()+'" class="zAwctFileUploadIE" ':this.getMultiple()&&!com.zespri.awct.util.Constants.C_IS_BROWSER_IE?'name="'+this.getId()+'[]" ':'name="'+this.getId()+'" class="zAwctFileUploadIE" '),a.push('id="'+this.getId()+'-fu" '),com.zespri.awct.util.Constants.C_IS_BROWSER_IE&&8===sap.ui.Device.browser.version||(com.zespri.awct.util.Constants.C_IS_BROWSER_IE&&9===sap.ui.Device.browser.version||a.push('tabindex="-1" '),a.push('size="1" ')),this.getTooltip_AsString()?a.push('title="'+jQuery.sap.escapeHTML(this.getTooltip_AsString())+'" '):this.getTooltip()||""!==this.getValue()&&a.push('title="'+jQuery.sap.escapeHTML(this.getValue())+'" '),this.getEnabled()||a.push('disabled="disabled" '),this.getMultiple()&&!com.zespri.awct.util.Constants.C_IS_BROWSER_IE&&a.push("multiple "),a.push(">"),this.oFileUpload=jQuery(a.join("")).prependTo(this.$().find(".zAwctDisplayIEUpload")).get(0)}if(!this.oIFrameRef){var b=document.createElement("iframe");b.style.display="none",b.src="javascript:''",b.id=this.sId+"-frame",sap.ui.getCore().getStaticAreaRef().appendChild(b),b.contentWindow.name=this.sId+"-frame";var c=this;this._bUploading=!1,jQuery(b).load(function(){if(c._bUploading){jQuery.sap.log.info("File uploaded to "+c.getUploadUrl());var a;try{a=c.oIFrameRef.contentDocument.body.innerText}catch(b){}c.fireUploadComplete({response:a}),c._bUploading=!1}}),this.oIFrameRef=b}},jQuery.sap.setObject("com.zespri.awct.control.FileUploaderHelper",{createTextField:function(a){var b=new sap.m.Input(a);return b},setTextFieldContent:function(a,b){a.setWidth(b)},createButton:function(){var a=new sap.m.Button;return a},bFinal:!0})}();
!function(){"use strict";jQuery.sap.declare("com.zespri.awct.control.SearchHelpInput"),sap.m.Input.extend("com.zespri.awct.control.SearchHelpInput",{renderer:"sap.m.InputRenderer",init:function(){this.setShowValueHelp(!0),this.setShowSuggestion(!0)},onAfterRendering:function(){sap.m.Input.prototype.onAfterRendering.apply(this),this.$().find(".sapMInputBaseInner").attr("readOnly","readOnly")}})}();
!function(){"use strict";jQuery.sap.declare("com.zespri.awct.control.DatePicker"),jQuery.sap.require("sap.ui.commons.DatePicker"),sap.ui.commons.DatePicker.extend("com.zespri.awct.control.DatePicker",{renderer:"sap.ui.commons.DatePickerRenderer",init:function(){sap.ui.commons.DatePicker.prototype.init.apply(this)},onAfterRendering:function(){sap.ui.commons.DatePicker.prototype.onAfterRendering.apply(this),sap.ui.Device.browser.mobile||this.$().find(".sapUiTfInner").attr("readOnly","readOnly")}})}();
!function(){"use strict";jQuery.sap.declare("com.zespri.awct.control.SharedContainerLinkRenderer"),jQuery.sap.require("sap.m.Link"),com.zespri.awct.control.SharedContainerLinkRenderer={},com.zespri.awct.control.SharedContainerLinkRenderer.render=function(a,b){var c=!1;if(b.getBindingContext()&&(c=b.getBindingContext().getProperty("IsContainerShared")),a.write("<div"),a.writeControlData(b),a.write(">"),c){var d=new sap.m.Link({text:b.getText(),press:[b.handleLinkPress,b],tooltip:b.getTooltip()});d.addStyleClass("zAwctLinkDashedUnderline"),a.renderControl(d)}else a.renderControl(new sap.m.Text({text:b.getText(),tooltip:b.getTooltip()}));a.write("</div>")}}();
!function(){"use strict";jQuery.sap.declare("com.zespri.awct.control.SharedContainerLink"),jQuery.sap.require("com.zespri.awct.util.NotificationHelper"),sap.ui.core.Control.extend("com.zespri.awct.control.SharedContainerLink",{_oPopover:void 0,metadata:{properties:{text:{type:"string",defaultValue:""}}},handlePopoverOKPress:function(){this._oPopover.close()},createPopover:function(){this._oPopover=new sap.m.Popover({placement:sap.m.PlacementType.Vertical,contentWidth:"250px",title:"{i18n>TXT_SHARED_CONTAINER_LINK_POPOVER_TITLE}",footer:new sap.m.Bar({contentMiddle:[new sap.m.Button({text:"{i18n>TXT_GENERIC_OK}",width:"100%",press:[this.handlePopoverOKPress,this]})]}),content:[new sap.m.Label({text:"{i18n>TXT_SHARED_CONTAINER_LINK_POPOVER_LABEL_CONTENT}"}),new sap.m.Label({design:"Bold"})]}).addStyleClass("zAwctPopoverPadding"),this._oPopover.setModel(this.getModel("i18n"),"i18n")},handleLinkPress:function(a){var b=this;b._oPopover||b.createPopover();var c=b.getBindingContext(),d=c.getProperty("DeliveryLineID"),e=c.getProperty("AllocationID");b._oPopover.openBy(a.getSource()),b._oPopover.setBusy(!0),b.getModel().read("/GetSharedSuppliers",{urlParameters:{DeliveryLineID:d,AllocationLineID:e},success:function(a){a.results.length&&b._oPopover.getContent()[1].setText(a.results.map(function(a){return a.Supplier}).join(", ")),b._oPopover.setBusy(!1)},error:function(a){com.zespri.awct.util.NotificationHelper.showErrorToast(com.zespri.awct.util.I18NHelper.getText("TXT_SHARED_CONTAINER_LINK_ERROR")),b._oPopover.close(),com.zespri.awct.util.NotificationHelper.handleErrorMessage(a)}})},renderer:"com.zespri.awct.control.SharedContainerLinkRenderer"})}();
!function(){"use strict";jQuery.sap.declare("com.zespri.awct.control.FacetFilterList"),jQuery.sap.require("com.zespri.awct.util.CommonHelper"),jQuery.sap.require("sap.m.library"),jQuery.sap.require("sap.m.List"),sap.m.List.extend("com.zespri.awct.control.FacetFilterList",{metadata:{publicMethods:["getSelectedKeys","setSelectedKeys","removeSelectedKey","removeSelectedKeys","clearSearchField"],library:"sap.m",properties:{title:{type:"string",group:"Appearance",defaultValue:null},multiSelect:{type:"boolean",group:"Behavior",defaultValue:!0,deprecated:!0},active:{type:"boolean",group:"Behavior",defaultValue:!0},allCount:{type:"int",group:"Appearance",defaultValue:null},sequence:{type:"int",group:"Behavior",defaultValue:-1},key:{type:"string",group:"Identification",defaultValue:null},showRemoveFacetIcon:{type:"boolean",group:"Misc",defaultValue:!0},retainListSequence:{type:"boolean",group:"Misc",defaultValue:!1},showInFacetFilterBar:{type:"boolean",defaultValue:!1},filterApplied:{type:"boolean",defaultValue:!1}},events:{listOpen:{},listClose:{}}},renderer:"sap.m.FacetFilterListRenderer"}),com.zespri.awct.control.FacetFilterList.M_EVENTS={listOpen:"listOpen",listClose:"listClose"},jQuery.sap.require("sap.ui.core.EnabledPropagator"),sap.ui.core.EnabledPropagator.call(com.zespri.awct.control.FacetFilterList.prototype),com.zespri.awct.control.FacetFilterList.prototype.setTitle=function(a){return this.setProperty("title",a,!0),this.getParent()&&this.getParent()._setButtonText&&this.getParent()._setButtonText(this),this},com.zespri.awct.control.FacetFilterList.prototype.clearSearchField=function(){var a=sap.ui.getCore().byId(this.getAssociation("search"));a?a.setValue(""):this._bPendingClearSearchField=!0},com.zespri.awct.control.FacetFilterList.prototype.setBusy=function(a){sap.ui.core.Control.prototype.setBusy.call(this,a);var b=sap.ui.getCore().byId(this.getAssociation("search"));b?b.setEnabled(!a):this._bSearchFieldEnabled=!a},com.zespri.awct.control.FacetFilterList.prototype.setMultiSelect=function(a){this.setProperty("multiSelect",a,!0);var b=a?sap.m.ListMode.MultiSelect:sap.m.ListMode.SingleSelectMaster;return this.setMode(b),this},com.zespri.awct.control.FacetFilterList.prototype.setMode=function(a){return(a===sap.m.ListMode.MultiSelect||a===sap.m.ListMode.SingleSelectMaster)&&(sap.m.List.prototype.setMode.call(this,a),this.setProperty("multiSelect",a===sap.m.ListMode.MultiSelect?!0:!1,!0)),this},com.zespri.awct.control.FacetFilterList.prototype._applySearch=function(){var a=this._getSearchValue();null!=a&&this._search(a,!0)},com.zespri.awct.control.FacetFilterList.prototype.getSelectedItems=function(){var a=[],b={},c=sap.m.ListBase.prototype.getSelectedItems.apply(this,arguments);c.forEach(function(c){a.push(new sap.m.FacetFilterItem({text:c.getText(),key:c.getKey(),selected:!0})),b[c.getKey()]=!0});var d=this.getSelectedKeys(),e=Object.getOwnPropertyNames(d);return c.length<e.length&&e.forEach(function(c){b[c]||a.push(new sap.m.FacetFilterItem({text:d[c],key:c,selected:!0}))}),a},com.zespri.awct.control.FacetFilterList.prototype.getSelectedItem=function(){var a=sap.m.ListBase.prototype.getSelectedItem.apply(this,arguments),b=Object.getOwnPropertyNames(this.getSelectedKeys());return!a&&b.length>0&&(a=new sap.m.FacetFilterItem({text:this.getSelectedKeys()[b[0]],key:b[0],selected:!0})),a},com.zespri.awct.control.FacetFilterList.prototype.removeSelections=function(a){return this._allowRemoveSelections&&(a?this.setSelectedKeys():sap.m.ListBase.prototype.removeSelections.call(this,a)),this},com.zespri.awct.control.FacetFilterList.prototype.getSelectedKeys=function(){var a={},b=this._oSelectedKeys;return Object.getOwnPropertyNames(b).forEach(function(c){a[c]=b[c]}),a},com.zespri.awct.control.FacetFilterList.prototype.setSelectedKeys=function(a){this._oSelectedKeys={};var b=!1;a&&Object.getOwnPropertyNames(a).forEach(function(c){this._addSelectedKey(c,a[c]),b=!0},this),b?(this.setActive(!0),this._selectItemsByKeys()):(sap.m.ListBase.prototype.removeSelections.call(this),this._searchValue=""),this._updateFilterAppliedState()},com.zespri.awct.control.FacetFilterList.prototype.removeSelectedKey=function(a,b){this._removeSelectedKey(a,b)&&this.getItems().forEach(function(b){var c=b.getKey()||b.getText();a===c&&b.setSelected(!1)})},com.zespri.awct.control.FacetFilterList.prototype.removeSelectedKeys=function(){this._oSelectedKeys={},sap.m.ListBase.prototype.removeSelections.call(this,!0)},com.zespri.awct.control.FacetFilterList.prototype.removeItem=function(){var a=sap.m.ListBase.prototype.removeItem.apply(this,arguments);return this._filtering?void 0:(a&&a.getSelected()&&this.removeSelectedKey(a.getKey(),a.getText()),a)},com.zespri.awct.control.FacetFilterList.prototype.init=function(){this._firstTime=!0,this._saveBindInfo=void 0,this._oSelectedKeys={},sap.m.List.prototype.init.call(this),this.setMode(sap.m.ListMode.MultiSelect),this.setIncludeItemInSelection(!0),this.setGrowing(!0),this.setRememberSelections(!1),this._searchValue=null,this.attachUpdateFinished(function(a){var b=a.getParameter("reason");b?(b=b.toLowerCase(),b!==sap.ui.model.ChangeReason.Filter.toLowerCase()&&this._selectItemsByKeys()):this._selectItemsByKeys()}),this._allowRemoveSelections=!0,this.attachSelect(this._handleSelect),this.attachListOpen(this._handleListOpen),this.getAssociation("allcheckbox")&&sap.ui.getCore().byId(this.getAssociation("allcheckbox")).attachSelect(this._handleAllCheckboxSelect),com.zespri.awct.util.CommonHelper.manageNoDataText(this)},com.zespri.awct.control.FacetFilterList.prototype._handleSelect=function(){this._setFilterModified(!0)},com.zespri.awct.control.FacetFilterList.prototype._handleListOpen=function(){this._setFilterModified(!1)},com.zespri.awct.control.FacetFilterList.prototype._handleAllCheckboxSelect=function(){this._setFilterModified(!0)},com.zespri.awct.control.FacetFilterList.prototype._setFilterModified=function(a){var b=sap.ui.getCore().byId(this.getAssociation("facetFilter"));b.setProperty("filtersModifiedAfterListOpen",a,!0)},com.zespri.awct.control.FacetFilterList.prototype._resetItemsBinding=function(){this.isBound("items")&&(this._searchValue=null,this._allowRemoveSelections=!1,sap.m.ListBase.prototype._resetItemsBinding.apply(this,arguments),this._allowRemoveSelections=!0)},com.zespri.awct.control.FacetFilterList.prototype._fireListCloseEvent=function(){var a=this.getSelectedItems(),b=this.getSelectedKeys(),c=0===a.length;this._firstTime=!0,this.fireListClose({selectedItems:a,selectedKeys:b,allSelected:c})},com.zespri.awct.control.FacetFilterList.prototype._updateActiveState=function(){var a=sap.ui.getCore().byId(this.getAssociation("allcheckbox"));(Object.getOwnPropertyNames(this._oSelectedKeys).length>0||a&&a.getSelected())&&this.setActive(!0)},com.zespri.awct.control.FacetFilterList.prototype._handleSearchEvent=function(a){var b=a.getParameters().query;void 0===b&&(b=a.getParameters().newValue),this._search(b),this._updateSelectAllCheckBox()},com.zespri.awct.control.FacetFilterList.prototype._search=function(a,b){var c,d=0;if(b||a!==this._searchValue){this._searchValue=a;var e=this.getBinding("items"),f=this.getBindingInfo("items");if(f&&f.binding&&(c=f.binding.aFilters,c.length>0&&(d=c[0].aFilters.length,this._firstTime&&(this._saveBindInfo=c[0].aFilters[0],this._firstTime=!1))),e){var g=[];if(a||d>0){var h=this.getBindingInfo("items").template.getBindingInfo("text").parts[0].path;if(h){var i=new sap.ui.model.Filter(h,sap.ui.model.FilterOperator.Contains,a);g=d>1?new sap.ui.model.Filter([i,this._saveBindInfo],!0):this._saveBindInfo>""&&i.sPath!==this._saveBindInfo.sPath?new sap.ui.model.Filter([i,this._saveBindInfo],!0):""===a?[]:new sap.ui.model.Filter([i],!0),e.filter(g,sap.ui.model.FilterType.Control)}}else e.filter([],sap.ui.model.FilterType.Control)}else jQuery.sap.log.warning("No filtering performed","The list must be defined with a binding for search to work",this)}},com.zespri.awct.control.FacetFilterList.prototype._getSearchValue=function(){return this._searchValue},com.zespri.awct.control.FacetFilterList.prototype._updateSelectAllCheckBox=function(a){if(this.getMultiSelect()){var b=sap.ui.getCore().byId(this.getAssociation("allcheckbox"));b&&b.setSelected(a?!1:0===Object.getOwnPropertyNames(this._oSelectedKeys).length&&this.getActive())}},com.zespri.awct.control.FacetFilterList.prototype._updateFilterAppliedState=function(){0===Object.getOwnPropertyNames(this._oSelectedKeys).length?this.setProperty("filterApplied",!1):this.setProperty("filterApplied",!0)},com.zespri.awct.control.FacetFilterList.prototype._addSelectedKey=function(a,b){return a||b?(this.getMode()===sap.m.ListMode.SingleSelectMaster&&this.removeSelectedKeys(),a||(a=b),void(this._oSelectedKeys[a]=b||a)):void jQuery.sap.log.error("Both sKey and sText are not defined. At least one must be defined.")},com.zespri.awct.control.FacetFilterList.prototype._removeSelectedKey=function(a,b){return a||b?(a||(a=b),delete this._oSelectedKeys[a],!0):(jQuery.sap.log.error("Both sKey and sText are not defined. At least one must be defined."),!1)},com.zespri.awct.control.FacetFilterList.prototype._isItemSelected=function(a){return!!this._oSelectedKeys[a&&(a.getKey()||a.getText())]},com.zespri.awct.control.FacetFilterList.prototype._selectItemsByKeys=function(){this.getItems().forEach(function(a){a.setSelected(this._isItemSelected(a))},this)},com.zespri.awct.control.FacetFilterList.prototype.onItemSetSelected=function(a,b){b?this._addSelectedKey(a.getKey(),a.getText()):this._removeSelectedKey(a.getKey(),a.getText()),sap.m.ListBase.prototype.onItemSetSelected.apply(this,arguments),this._updateSelectAllCheckBox(b),this._updateFilterAppliedState(),this.setActive(this.getActive()||b),!this.getDomRef()&&this.getParent()&&this.getParent().getDomRef()&&this.getParent().invalidate()},com.zespri.awct.control.FacetFilterList.prototype.updateItems=function(a){this._filtering=a===sap.ui.model.ChangeReason.Filter,sap.m.ListBase.prototype.updateItems.apply(this,arguments),this._filtering=!1,this.getGrowing()&&a!==sap.ui.model.ChangeReason.Filter||this._selectItemsByKeys()}}();
!function(){"use strict";jQuery.sap.declare("com.zespri.awct.control.FacetFilterNumberInputListRenderer"),jQuery.sap.require("com.zespri.awct.util.I18NHelper"),com.zespri.awct.control.FacetFilterNumberInputListRenderer={},com.zespri.awct.control.FacetFilterNumberInputListRenderer.render=function(a,b){var c=(new sap.ui.layout.VerticalLayout).addStyleClass("zAwctFacetFilterInputListVerticalLayoutMargin"),d=new sap.ui.layout.HorizontalLayout({width:"100%"}).addStyleClass("zAwctFacetFilterInputListHorizontalLayoutAdjustment"),e=new sap.m.Label({text:com.zespri.awct.util.I18NHelper.getText("TXT_FACET_FILTER_NUMBER_INPUT_LIST_LABEL")}),f=sap.ui.getCore().byId(b.getNumberInput()),g=new sap.m.Button({icon:"sap-icon://sys-cancel",tooltip:com.zespri.awct.util.I18NHelper.getText("TXT_FACET_FILTER_NUMBER_INPUT_LIST_CLEAR_TOOLTIP")}).attachPress(jQuery.proxy(b._handleClearButtonPress,b));d.addContent(f).addContent(g),c.addContent(e).addContent(d),a.renderControl(c)}}();
!function(){"use strict";jQuery.sap.declare("com.zespri.awct.control.FacetFilterNumberInputList"),jQuery.sap.require("com.zespri.awct.control.FacetFilterList"),jQuery.sap.require("com.zespri.awct.util.I18NHelper"),com.zespri.awct.control.FacetFilterList.extend("com.zespri.awct.control.FacetFilterNumberInputList",{metadata:{associations:{numberInput:{type:"sap.m.Input"}}},renderer:"com.zespri.awct.control.FacetFilterNumberInputListRenderer",_iLastValidValue:void 0,init:function(){var a=this;com.zespri.awct.control.FacetFilterList.prototype.init.apply(this),this.setNumberInput(new sap.m.Input({change:[this._handleInputChange,a]}))},setSelectedKeys:function(a){var b=sap.ui.getCore().byId(this.getNumberInput());b.setValueState(sap.ui.core.ValueState.None),a?(b.setValue(a[0].value),this._iLastValidValue=a[0].value,this.setProperty("filterApplied",!0)):(b.setValue(null),this._iLastValidValue=void 0,this.setProperty("filterApplied",!1)),b.rerender()},_handleClearButtonPress:function(){this.setSelectedKeys(),this.setProperty("filterApplied",!1)},_handleInputChange:function(){var a=sap.ui.getCore().byId(this.getNumberInput()),b=a.getValue();if(isNaN(b)||isNaN(parseInt(b,10))){var c=com.zespri.awct.util.I18NHelper.getText("TXT_FACET_FILTER_NUMBER_INPUT_WARNING_TEXT");a.setValueState(sap.ui.core.ValueState.Warning),a.setValueStateText(c),void 0!==this._iLastValidValue?a.setValue(this._iLastValidValue):(a.setValue(null),this.setProperty("filterApplied",!1))}else{a.setValueState(sap.ui.core.ValueState.None),this._iLastValidValue=parseInt(b,10);var d=sap.ui.getCore().byId(this.getAssociation("facetFilter"));d.setProperty("filtersModifiedAfterListOpen",!0,!0),this.setProperty("filterApplied",!0)}},getSelectedItems:function(){return this._iLastValidValue>=0?[{_sKey:this._iLastValidValue,getKey:function(){return this._sKey}}]:[]}})}();
!function(){"use strict";jQuery.sap.declare("com.zespri.awct.control.FacetFilterDateInputListRenderer"),jQuery.sap.require("com.zespri.awct.util.I18NHelper"),com.zespri.awct.control.FacetFilterDateInputListRenderer={},com.zespri.awct.control.FacetFilterDateInputListRenderer.render=function(a,b){var c=(new sap.ui.layout.VerticalLayout).addStyleClass("zAwctFacetFilterInputListVerticalLayoutMargin"),d=new sap.ui.layout.HorizontalLayout({width:"100%"}).addStyleClass("zAwctFacetFilterInputListHorizontalLayoutAdjustment"),e=new sap.m.Label({text:com.zespri.awct.util.I18NHelper.getText("TXT_FACET_FILTER_DATE_INPUT_LIST_LABEL")}),f=sap.ui.getCore().byId(b.getDateInput()),g=new sap.m.Button({icon:"sap-icon://sys-cancel",tooltip:com.zespri.awct.util.I18NHelper.getText("TXT_FACET_FILTER_DATE_INPUT_LIST_CLEAR_TOOLTIP")}).attachPress(jQuery.proxy(b._handleClearButtonPress,b));d.addContent(f).addContent(g),c.addContent(e).addContent(d),a.renderControl(c)}}();
!function(){"use strict";jQuery.sap.declare("com.zespri.awct.control.FacetFilterDateInputList"),jQuery.sap.require("com.zespri.awct.control.FacetFilterList"),jQuery.sap.require("com.zespri.awct.util.CommonFormatHelper"),jQuery.sap.require("com.zespri.awct.control.DatePicker"),com.zespri.awct.control.FacetFilterList.extend("com.zespri.awct.control.FacetFilterDateInputList",{metadata:{associations:{dateInput:{type:"com.zespri.awct.control.DatePicker"}}},renderer:"com.zespri.awct.control.FacetFilterDateInputListRenderer",init:function(){com.zespri.awct.control.FacetFilterList.prototype.init.apply(this);var a=this;this.setDateInput(new com.zespri.awct.control.DatePicker({change:[this._handleDateInputChange,a]}))},setSelectedKeys:function(a){if(!a){var b=sap.ui.getCore().byId(this.getDateInput());b.setValue(null),b.rerender(),this.setProperty("filterApplied",!1)}},_handleDateInputChange:function(){var a=sap.ui.getCore().byId(this.getAssociation("facetFilter"));a.setProperty("filtersModifiedAfterListOpen",!0,!0),this.setProperty("filterApplied",!0)},_getExternalFormatValue:function(a){var b=a.substring(0,4),c=a.substring(4,6),d=a.substring(6,8);return b+"-"+c+"-"+d},_handleClearButtonPress:function(){this.setSelectedKeys(),this.setProperty("filterApplied",!1)},getSelectedItems:function(){var a=sap.ui.getCore().byId(this.getDateInput());return a&&a.getValue()?[{_sKey:this._getExternalFormatValue(a.getYyyymmdd()),getKey:function(){return this._sKey}}]:[]}})}();
!function(){"use strict";jQuery.sap.declare("com.zespri.awct.control.FacetFilterCheckboxListRenderer"),jQuery.sap.require("com.zespri.awct.util.I18NHelper"),com.zespri.awct.control.FacetFilterCheckboxListRenderer={},com.zespri.awct.control.FacetFilterCheckboxListRenderer.render=function(a,b){var c=(new sap.ui.layout.VerticalLayout).addStyleClass("zAwctFacetFilterInputListVerticalLayoutMargin"),d=new sap.ui.layout.HorizontalLayout({width:"100%"}).addStyleClass("zAwctFacetFilterInputListHorizontalLayoutAdjustment"),e=sap.ui.getCore().byId(b.getCheckboxInput());d.addContent(e),c.addContent(d),a.renderControl(c)}}();
!function(){"use strict";jQuery.sap.declare("com.zespri.awct.control.FacetFilterCheckboxList"),jQuery.sap.require("com.zespri.awct.control.FacetFilterList"),jQuery.sap.require("com.zespri.awct.util.I18NHelper"),com.zespri.awct.control.FacetFilterList.extend("com.zespri.awct.control.FacetFilterCheckboxList",{metadata:{associations:{checkboxInput:{type:"sap.m.CheckBox"}}},renderer:"com.zespri.awct.control.FacetFilterCheckboxListRenderer",init:function(){var a=this;this.setCheckboxInput(new sap.m.CheckBox({selected:!0,select:[this._handleCheckBoxSelect,a]})),com.zespri.awct.control.FacetFilterList.prototype.init.apply(this)},setSelectedKeys:function(a){var b=sap.ui.getCore().byId(this.getCheckboxInput());a?(b.setSelected(a[0].value),a[0].value?this.setProperty("filterApplied",!1):this.setProperty("filterApplied",!0)):(b.setSelected(!0),this.setProperty("filterApplied",!1))},_handleCheckBoxSelect:function(a){var b=sap.ui.getCore().byId(this.getAssociation("facetFilter"));b.setProperty("filtersModifiedAfterListOpen",!0,!0),a.getParameter("selected")?this.setProperty("filterApplied",!1):this.setProperty("filterApplied",!0)},setTitle:function(a){var b=sap.ui.getCore().byId(this.getCheckboxInput());b.setText(a),com.zespri.awct.control.FacetFilterList.prototype.setTitle.apply(this,[a])},getSelectedItems:function(){var a=sap.ui.getCore().byId(this.getCheckboxInput());return a&&a.getSelected()?[{_sKey:!0,getKey:function(){return this._sKey}}]:[{_sKey:!1,getKey:function(){return this._sKey}}]}})}();
!function(){"use strict";jQuery.sap.declare("com.zespri.awct.control.FacetFilterRenderer"),jQuery.sap.require("sap.m.FacetFilterRenderer"),com.zespri.awct.control.FacetFilterRenderer={},com.zespri.awct.control.FacetFilterRenderer.render=function(a,b){if(b.getVisible())switch(b.getType()){case sap.m.FacetFilterType.Simple:com.zespri.awct.control.FacetFilterRenderer.renderSimpleFlow(a,b);break;case sap.m.FacetFilterType.Light:com.zespri.awct.control.FacetFilterRenderer.renderSummaryBar(a,b)}},com.zespri.awct.control.FacetFilterRenderer.renderSimpleFlow=function(a,b){a.write("<div");var c=b.getDisabledText();if(b.getEnabled()||a.writeAttributeEscaped("title",c),a.writeControlData(b),a.addClass("sapMFF"),b.getShowSummaryBar())a.write(">"),sap.m.FacetFilterRenderer.renderSummaryBar(a,b);else{a.addClass(b._lastScrolling?"sapMFFScrolling":"sapMFFNoScrolling"),b.getShowReset()&&a.addClass("sapMFFResetSpacer"),a.writeClasses(),a.write(">"),sap.ui.Device.system.desktop&&a.renderControl(b._getScrollingArrow("left")),a.write("<div"),a.writeAttribute("id",b.getId()+"-head"),a.writeControlData(b),a.addClass("sapMFFHead"),a.writeClasses(),a.write(">");for(var d=b._getSequencedLists(),e=0;e<d.length;e++)d[e].getShowInFacetFilterBar()&&(a.renderControl(b._getButtonForList(d[e])),b.getShowPersonalization()&&a.renderControl(b._getFacetRemoveIcon(d[e])));if(b.getShowPersonalization()){var f=b.getAggregation("addFacetButton"),g=!1;$.each(d,function(a,b){return b.getProperty("filterApplied")===!0&&b.getProperty("showInFacetFilterBar")===!1?(g=!0,!1):void 0}),g?(f.addStyleClass("zAwctSecondaryFiltersApplied"),f.setTooltip(com.zespri.awct.util.I18NHelper.getText("TXT_FACET_FILTER_SECONDARY_FILTERS_APPLIED_MORE_BUTTON_TOOLTIP"))):(f.removeStyleClass("zAwctSecondaryFiltersApplied"),f.setTooltip(com.zespri.awct.util.I18NHelper.getText("TXT_FACET_FILTER_MORE_TOOLTIP"))),a.renderControl(f)}a.write("</div>"),sap.ui.Device.system.desktop&&a.renderControl(b._getScrollingArrow("right")),b.getShowReset()&&(a.write("<div"),a.addClass("sapMFFResetDiv"),a.writeClasses(),a.write(">"),a.renderControl(b.getAggregation("resetButton")),a.write("</div>"))}a.write("</div>")},com.zespri.awct.control.FacetFilterRenderer.renderSummaryBar=function(a,b){a.write("<div"),a.writeControlData(b),a.addClass("sapMFF"),a.writeClasses(),a.write(">");var c=b.getAggregation("summaryBar");a.renderControl(c),a.write("</div>")}}();
!function(){"use strict";jQuery.sap.declare("com.zespri.awct.control.FacetFilter"),jQuery.sap.require("com.zespri.awct.control.FacetFilterCheckboxList"),jQuery.sap.require("com.zespri.awct.control.FacetFilterDateInputList"),jQuery.sap.require("com.zespri.awct.control.FacetFilterNumberInputList"),jQuery.sap.require("com.zespri.awct.util.CommonHelper"),jQuery.sap.require("com.zespri.awct.util.I18NHelper"),jQuery.sap.require("sap.m.library"),jQuery.sap.require("sap.m.NavContainer"),jQuery.sap.require("sap.ui.core.Control"),jQuery.sap.require("sap.ui.core.IconPool"),sap.ui.core.Control.extend("com.zespri.awct.control.FacetFilter",{metadata:{publicMethods:["openFilterDialog"],library:"sap.m",properties:{visible:{type:"boolean",group:"Appearance",defaultValue:!0},showPersonalization:{type:"boolean",group:"Appearance",defaultValue:!1},type:{type:"sap.m.FacetFilterType",group:"Appearance",defaultValue:sap.m.FacetFilterType.Simple},liveSearch:{type:"boolean",group:"Behavior",defaultValue:!0},showSummaryBar:{type:"boolean",group:"Behavior",defaultValue:!1},showReset:{type:"boolean",group:"Behavior",defaultValue:!0},showPopoverOKButton:{type:"boolean",group:"Appearance",defaultValue:!1},filtersModifiedAfterListOpen:{type:"boolean",defaultValue:!1},enabled:{type:"boolean",group:"Behavior",defaultValue:!0},disabledText:{type:"string",defaultValue:""}},defaultAggregation:"lists",aggregations:{lists:{type:"com.zespri.awct.control.FacetFilterList",multiple:!0,singularName:"list"},buttons:{type:"sap.m.Button",multiple:!0,singularName:"button",visibility:"hidden"},removeFacetIcons:{type:"sap.ui.core.Icon",multiple:!0,singularName:"removeFacetIcon",visibility:"hidden"},popover:{type:"sap.m.Popover",multiple:!1,visibility:"hidden"},addFacetButton:{type:"sap.m.Button",multiple:!1,visibility:"hidden"},dialog:{type:"sap.m.Dialog",multiple:!1,visibility:"hidden"},summaryBar:{type:"sap.m.Toolbar",multiple:!1,visibility:"hidden"},resetButton:{type:"sap.m.Button",multiple:!1,visibility:"hidden"},arrowLeft:{type:"sap.ui.core.Icon",multiple:!1,visibility:"hidden"},arrowRight:{type:"sap.ui.core.Icon",multiple:!1,visibility:"hidden"}},events:{reset:{}}},renderer:"com.zespri.awct.control.FacetFilterRenderer"}),com.zespri.awct.control.FacetFilter.M_EVENTS={reset:"reset"},jQuery.sap.require("sap.ui.core.EnabledPropagator"),sap.ui.core.EnabledPropagator.call(com.zespri.awct.control.FacetFilter.prototype),com.zespri.awct.control.FacetFilter.SCROLL_STEP=264,com.zespri.awct.control.FacetFilter.prototype.setType=function(a){var b=this.getAggregation("summaryBar");sap.ui.Device.system.phone?(this.setProperty("type",sap.m.FacetFilterType.Light),b.setActive(!0)):(this.setProperty("type",a),b.setActive(a===sap.m.FacetFilterType.Light)),a===sap.m.FacetFilterType.Light&&(this.getShowReset()?this._addResetToSummary(b):this._removeResetFromSummary(b))},com.zespri.awct.control.FacetFilter.prototype.setShowReset=function(a){this.setProperty("showReset",a);var b=this.getAggregation("summaryBar");a?(this.getShowSummaryBar()||this.getType()===sap.m.FacetFilterType.Light)&&this._addResetToSummary(b):(this.getShowSummaryBar()||this.getType()===sap.m.FacetFilterType.Light)&&this._removeResetFromSummary(b)},com.zespri.awct.control.FacetFilter.prototype.setShowSummaryBar=function(a){if(this.setProperty("showSummaryBar",a),a){var b=this.getAggregation("summaryBar");this.getShowReset()?this._addResetToSummary(b):this._removeResetFromSummary(b),b.setActive(this.getType()===sap.m.FacetFilterType.Light)}},com.zespri.awct.control.FacetFilter.prototype.setLiveSearch=function(a){if(this.setProperty("liveSearch",a),this._displayedList){var b=this._displayedList,c=sap.ui.getCore().byId(b.getAssociation("search"));c.detachLiveChange(b._handleSearchEvent,b),a&&c.attachLiveChange(b._handleSearchEvent,b)}return this},com.zespri.awct.control.FacetFilter.prototype.getLists=function(){var a=this.getAggregation("lists");return a||(a=[]),this._displayedList&&a.splice(this._listAggrIndex,0,this._displayedList),a},com.zespri.awct.control.FacetFilter.prototype.removeList=function(a){var b=sap.ui.base.ManagedObject.prototype.removeAggregation.call(this,"lists",a);return this._removeList(b),b},com.zespri.awct.control.FacetFilter.prototype.removeAggregation=function(){var a=sap.ui.base.ManagedObject.prototype.removeAggregation.apply(this,arguments);return"lists"===arguments[0]&&this._removeList(a),a},com.zespri.awct.control.FacetFilter.prototype.openFilterDialog=function(){var a=this._getFacetDialog(),b=this._getFacetDialogNavContainer();return a.addContent(b),a.open(),this},com.zespri.awct.control.FacetFilter.prototype.getWidth=function(){return"100%"},com.zespri.awct.control.FacetFilter.prototype.init=function(){this._bundle=sap.ui.getCore().getLibraryResourceBundle("sap.m"),this._buttons={},this._removeFacetIcons={},this._listAggrIndex=-1,this._displayedList=null,this._lastScrolling=!1,this._bPreviousScrollForward=!1,this._bPreviousScrollBack=!1,this._getAddFacetButton(),this._getSummaryBar(),this.setAggregation("resetButton",this._createResetButton()),"ON"!==jQuery.sap.touchEventMode||sap.ui.Device.system.phone||this._enableTouchSupport(),sap.ui.Device.system.phone&&this.setType(sap.m.FacetFilterType.Light)},com.zespri.awct.control.FacetFilter.prototype.exit=function(){sap.ui.getCore().detachIntervalTimer(this._checkOverflow,this)},com.zespri.awct.control.FacetFilter.prototype.onBeforeRendering=function(){if(this.getShowSummaryBar()||this.getType()===sap.m.FacetFilterType.Light){var a=this.getAggregation("summaryBar"),b=a.getContent()[0];b.setText(this._getSummaryText()),b.setTooltip(this._getSummaryText())}sap.ui.getCore().detachIntervalTimer(this._checkOverflow,this)},com.zespri.awct.control.FacetFilter.prototype.onAfterRendering=function(){sap.ui.Device.system.phone||sap.ui.getCore().attachIntervalTimer(this._checkOverflow,this)},com.zespri.awct.control.FacetFilter.prototype._getPopover=function(){var a=this.getAggregation("popover");if(!a){var b=this;a=new sap.m.Popover({placement:sap.m.PlacementType.Bottom,beforeOpen:function(){this.setCustomHeader(b._createFilterItemsSearchFieldBar(b._displayedList));var a=this.getSubHeader();a||this.setSubHeader(b._createSelectAllCheckboxBar(b._displayedList))},afterClose:function(){var a=b._restoreListFromDisplayContainer(this);com.zespri.awct.util.Constants.C_IS_BROWSER_IE&&sap.ui.Device.browser.version<10?jQuery.sap.delayedCall(100,b,b._handlePopoverAfterClose,[a]):b._handlePopoverAfterClose(a)},horizontalScrolling:!1}),this.setAggregation("popover",a,!0),a.addStyleClass("sapMFFPop")}return this.getShowPopoverOKButton()?this._addOKButtonToPopover(a):a.destroyAggregation("footer"),a},com.zespri.awct.control.FacetFilter.prototype._handlePopoverAfterClose=function(a){this._displayRemoveIcon(!1,a),a._fireListCloseEvent(),this.destroyAggregation("popover"),this._oOpenPopoverDeferred&&jQuery.sap.delayedCall(0,this,function(){this._oOpenPopoverDeferred.resolve(),this._oOpenPopoverDeferred=void 0})},com.zespri.awct.control.FacetFilter.prototype._openPopover=function(a,b){if(!a.isOpen()){var c=sap.ui.getCore().byId(b.getAssociation("list"));jQuery.sap.assert(c,"The facet filter button should be associated with a list."),this._moveListToDisplayContainer(c,a),c.fireListOpen({}),a.openBy(b)}return this},com.zespri.awct.control.FacetFilter.prototype._getAddFacetButton=function(){var a=this.getAggregation("addFacetButton");if(!a){var b=this,c=com.zespri.awct.util.I18NHelper.getText("TXT_FACET_FILTER_MORE_TOOLTIP");a=new sap.m.Button(this.getId()+"-add",{icon:sap.ui.core.IconPool.getIconURI("add-filter"),type:sap.m.ButtonType.Transparent,tooltip:c,press:function(){b.openFilterDialog()}}),this.setAggregation("addFacetButton",a,!0)}return a},com.zespri.awct.control.FacetFilter.prototype._getButtonForList=function(a){if(this._buttons[a.getId()]){var b=a.getEnabled();return this._buttons[a.getId()].setEnabled(b),this._setButtonText(a),this._buttons[a.getId()]}var c=this,d=new sap.m.Button({enabled:a.getEnabled(),type:sap.m.ButtonType.Transparent,press:function(){var a=this,b=function(){var b=c._getPopover();c._openPopover(b,a)};if(com.zespri.awct.util.Constants.C_IS_BROWSER_IE&&sap.ui.Device.browser.version<10)jQuery.sap.delayedCall(100,this,b);else{var d=c._getPopover();d.isOpen()?(c._oOpenPopoverDeferred=jQuery.Deferred(),c._oOpenPopoverDeferred.promise().done(b)):c._openPopover(d,this)}}});return this._buttons[a.getId()]=d,this.addAggregation("buttons",d),d.setAssociation("list",a.getId(),!0),this._setButtonText(a),d},com.zespri.awct.control.FacetFilter.prototype._setButtonText=function(a){var b=this._buttons[a.getId()];if(b){var c="",d=Object.getOwnPropertyNames(a._oSelectedKeys),e=d.length;if(e>0){var f=1===e?a._oSelectedKeys[d[0]]:e;c=this._bundle.getText("FACETFILTER_ITEM_SELECTION",[a.getTitle(),f])}else c=this._bundle.getText("FACETFILTER_ALL_SELECTED",[a.getTitle()]);b.setText(c),b.setTooltip(c)}},com.zespri.awct.control.FacetFilter.prototype._getFacetRemoveIcon=function(a){var b=this._removeFacetIcons[a.getId()];return b||(b=new sap.ui.core.Icon({src:sap.ui.core.IconPool.getIconURI("sys-cancel"),tooltip:this._bundle.getText("FACETFILTER_REMOVE"),press:function(){var a=sap.ui.getCore().byId(this.getAssociation("list"));a.removeSelections(!0),a.setSelectedKeys(),a.setProperty("active",!1,!0)}}),b.setAssociation("list",a.getId(),!0),b.addStyleClass("sapMFFLRemoveIcon"),this._removeFacetIcons[a.getId()]=b,this.addAggregation("removeFacetIcons",b),this._displayRemoveIcon(!1,a)),b},com.zespri.awct.control.FacetFilter.prototype._displayRemoveIcon=function(a,b){if(this.getShowPersonalization()){var c=this._removeFacetIcons[b.getId()];a?(c.removeStyleClass("sapMFFLHiddenRemoveIcon"),c.addStyleClass("sapMFFLVisibleRemoveIcon")):(c.removeStyleClass("sapMFFLVisibleRemoveIcon"),c.addStyleClass("sapMFFLHiddenRemoveIcon"))}},com.zespri.awct.control.FacetFilter.prototype._getFacetDialogNavContainer=function(){var a=new sap.m.NavContainer,b=this._createFacetPage();a.addPage(b),a.setInitialPage(b);var c=this;return a.attachAfterNavigate(function(a){var d=a.getParameters().to,e=a.getParameters().from;d===b&&(e.destroySubHeader(),jQuery.sap.assert(null===c._displayedList,"Filter items list should have been placed back in the FacetFilter aggregation before page content is destroyed."),e.destroyContent(),c._selectedFacetItem.invalidate(),c._selectedFacetItem=null)}),a},com.zespri.awct.control.FacetFilter.prototype._createFacetPage=function(){var a=this._createFacetList(),b=new sap.m.SearchField({width:"100%",tooltip:this._bundle.getText("Search"),liveChange:function(b){var c=a.getBinding("items");if(c){var d=new sap.ui.model.Filter("text",sap.ui.model.FilterOperator.Contains,b.getParameters().newValue);c.filter([d])}}}),c=new sap.m.Page({enableScrolling:!0,title:com.zespri.awct.util.I18NHelper.getText("TXT_FACETFILTER_DIALOG_TITLE_TEXT"),subHeader:new sap.m.Bar({contentMiddle:b}),content:[a]});return c},com.zespri.awct.control.FacetFilter.prototype._createFilterItemsPage=function(){var a=this,b=new sap.m.Page({showNavButton:!0,enableScrolling:!0,navButtonPress:function(b){var c=b.getSource().getParent();a._navFromFilterItemsPage(c)}});return b},com.zespri.awct.control.FacetFilter.prototype._getFilterItemsPage=function(a){var b=a.getPages()[1];b&&(a.removePage(b),b.destroy());var c=this._createFilterItemsPage();return a.addPage(c),c},com.zespri.awct.control.FacetFilter.prototype._createFilterItemsSearchFieldBar=function(a){if(a instanceof com.zespri.awct.control.FacetFilterDateInputList||a instanceof com.zespri.awct.control.FacetFilterNumberInputList||a instanceof com.zespri.awct.control.FacetFilterCheckboxList)return null;var b=this,c=new sap.m.SearchField({value:a._getSearchValue(),width:"100%",tooltip:this._bundle.getText("FACETFILTER_SEARCH"),search:function(a){b._displayedList._handleSearchEvent(a)}});this.getLiveSearch()&&c.attachLiveChange(a._handleSearchEvent,a);var d=new sap.m.Bar({contentMiddle:c});return a.setAssociation("search",c),a._bPendingClearSearchField&&(c.setValue(),a._bPendingClearSearchField=!1),c.setEnabled(a._bSearchFieldEnabled),d},com.zespri.awct.control.FacetFilter.prototype._getFacetDialog=function(){var a=this.getAggregation("dialog");if(!a){var b=this;a=new sap.m.Dialog({showHeader:!1,stretch:sap.ui.Device.system.phone?!0:!1,afterClose:function(){var a=this.getContent()[0],c=a.getPages()[1];if(a.getCurrentPage()===c){var d=b._restoreListFromDisplayContainer(c);d._updateActiveState(),d._fireListCloseEvent()}this.destroyAggregation("content",!0),b.invalidate()},beginButton:new sap.m.Button({text:this._bundle.getText("FACETFILTER_ACCEPT"),tooltip:this._bundle.getText("FACETFILTER_ACCEPT"),press:function(){b._closeDialog()}}),contentHeight:"500px"}),a.addStyleClass("sapMFFDialog"),this.setAggregation("dialog",a,!0)}return a},com.zespri.awct.control.FacetFilter.prototype._closeDialog=function(){var a=this.getAggregation("dialog");a&&a.isOpen()&&a.close()},com.zespri.awct.control.FacetFilter.prototype._closePopover=function(){var a=this.getAggregation("popover");a&&a.isOpen()&&a.close()},com.zespri.awct.control.FacetFilter.prototype._createFacetList=function(){for(var a=new sap.m.List({mode:sap.m.ListMode.None,items:{path:"/items",template:new sap.m.StandardListItem({title:"{text}",tooltip:"{text}",counter:"{count}",type:sap.m.ListType.Navigation,customData:[new sap.ui.core.CustomData({key:"index",value:"{index}"})]})}}),b=[],c=0;c<this.getLists().length;c++){var d=this.getLists()[c];b.push({text:d.getTitle(),tooltip:d.getTitle(),count:d.getAllCount(),index:c})}var e=new sap.ui.model.json.JSONModel({items:b}),f=this;return a.attachUpdateFinished(function(){for(var b=0;b<a.getItems().length;b++){var c=this.getItems()[b];c.detachPress(f._handleFacetListItemPress,f),c.attachPress(f._handleFacetListItemPress,f)}}),a.setModel(e),com.zespri.awct.util.CommonHelper.manageNoDataText(a),a},com.zespri.awct.control.FacetFilter.prototype._createSelectAllCheckboxBar=function(a){if(a instanceof com.zespri.awct.control.FacetFilterDateInputList||a instanceof com.zespri.awct.control.FacetFilterNumberInputList||a instanceof com.zespri.awct.control.FacetFilterCheckboxList)return null;if(!a.getMultiSelect())return null;var b=new sap.m.CheckBox(a.getId()+"-selectAll",{text:this._bundle.getText("FACETFILTER_CHECKBOX_ALL"),tooltip:this._bundle.getText("FACETFILTER_CHECKBOX_ALL"),selected:a.getActive()&&!a.getSelectedItem()&&!Object.getOwnPropertyNames(a._oSelectedKeys).length,select:function(a){d(!a.getParameter("selected"))}});a.setAssociation("allcheckbox",b);var c=new sap.m.Bar;c.addEventDelegate({ontap:function(a){a.srcControl===this&&d(b.getSelected())}},c),c.addContentLeft(b);var d=function(c){b.setSelected(a.getActive()?!0:!c),b.getSelected()&&(a.removeSelections(!0),a.setSelectedKeys());var d=sap.ui.getCore().byId(a.getAssociation("facetFilter"));d.setProperty("filtersModifiedAfterListOpen",!0,!0)};return c.addStyleClass("sapMFFCheckbar"),c},com.zespri.awct.control.FacetFilter.prototype._handleFacetListItemPress=function(a){this._navToFilterItemsPage(a.getSource())},com.zespri.awct.control.FacetFilter.prototype._navToFilterItemsPage=function(a){this._selectedFacetItem=a;var b=this.getAggregation("dialog").getContent()[0],c=a.getCustomData();jQuery.sap.assert(1===c.length,"There should be exactly one custom data for the original facet list item index");var d=c[0].getValue(),e=this.getLists()[d];if(this._listIndexAgg=this.indexOfAggregation("lists",e),this._listIndexAgg===d){var f=this._getFilterItemsPage(b);this._moveListToDisplayContainer(e,f),f.setSubHeader(this._createFilterItemsSearchFieldBar(e));var g=this._createSelectAllCheckboxBar(e);g&&f.insertContent(g,0),f.setTitle(com.zespri.awct.util.I18NHelper.getText("TXT_FACETFILTER_DIALOG_TITLE_TEXT")+": "+e.getTitle()),e.fireListOpen({}),b.to(f)}},com.zespri.awct.control.FacetFilter.prototype._navFromFilterItemsPage=function(a){var b=a.getPages()[1],c=this._restoreListFromDisplayContainer(b);c._updateActiveState(),c._fireListCloseEvent(),this._selectedFacetItem.setCounter(c.getAllCount()),a.backToTop()},com.zespri.awct.control.FacetFilter.prototype._moveListToDisplayContainer=function(a,b){this._listAggrIndex=this.indexOfAggregation("lists",a),jQuery.sap.assert(this._listAggrIndex>-1,"The lists index should be valid."),sap.ui.base.ManagedObject.prototype.removeAggregation.call(this,"lists",a,!0),b.addAggregation("content",a,!1),a.setAssociation("facetFilter",this,!0),this._displayedList=a},com.zespri.awct.control.FacetFilter.prototype._restoreListFromDisplayContainer=function(a){var b=a.removeAggregation("content",this._displayedList,!0);return this.insertAggregation("lists",b,this._listAggrIndex,b.getActive()),this._listAggrIndex=-1,this._displayedList=null,b},com.zespri.awct.control.FacetFilter.prototype._getSequencedLists=function(){var a=-1,b=[],c=this.getLists();if(c.length>0){for(var d=0;d<c.length;d++)c[d].getActive()?(c[d].getSequence()<-1?c[d].setSequence(-1):c[d].getSequence()>a&&(a=c[d].getSequence()),b.push(c[d])):c[d].getRetainListSequence()||c[d].setSequence(-1);for(var e=0;e<b.length;e++)b[e].getSequence()<=-1&&(a+=1,b[e].setSequence(a));b.length>1&&b.sort(function(a,b){return a.getSequence()-b.getSequence()})}return b},com.zespri.awct.control.FacetFilter.prototype._getSummaryBar=function(){var a=this.getAggregation("summaryBar");if(!a){var b=new sap.m.Text({maxLines:1}),c=this;a=new sap.m.Toolbar({content:[b],active:this.getType()===sap.m.FacetFilterType.Light?!0:!1,design:sap.m.ToolbarDesign.Info,height:"auto",press:function(){c.openFilterDialog()}}),this.setAggregation("summaryBar",a)}return a},com.zespri.awct.control.FacetFilter.prototype._createResetButton=function(){var a=this,b=new sap.m.Button({type:sap.m.ButtonType.Transparent,icon:sap.ui.core.IconPool.getIconURI("undo"),tooltip:com.zespri.awct.util.I18NHelper.getText("TXT_GENERIC_RESET"),press:function(){a.fireReset(),a.setProperty("filtersModifiedAfterListOpen",!1,!0),a.invalidate()}});return b},com.zespri.awct.control.FacetFilter.prototype._addOKButtonToPopover=function(a){var b=a.getFooter();if(!b){var c=this;b=new sap.m.Button({text:this._bundle.getText("FACETFILTER_ACCEPT"),tooltip:this._bundle.getText("FACETFILTER_ACCEPT"),width:"100%",press:function(){c._closePopover()}}),a.setFooter(b)}return b},com.zespri.awct.control.FacetFilter.prototype._getSummaryText=function(){var a=", ",b=" ",c="",d=!0,e=this.getLists();if(e.length>0)for(var f=0;f<e.length;f++){var g=e[f];if(g.getActive()){for(var h=this._getSelectedItemsText(g),i="",j=0;j<h.length;j++)i=i+h[j]+a;i&&(i=i.substring(0,i.lastIndexOf(a)).trim(),d?(c=this._bundle.getText("FACETFILTER_INFOBAR_FILTERED_BY",[g.getTitle(),i]),d=!1):c=c+b+this._bundle.getText("FACETFILTER_INFOBAR_AND")+b+this._bundle.getText("FACETFILTER_INFOBAR_AFTER_AND",[g.getTitle(),i]))}}return c||(c=this._bundle.getText("FACETFILTER_INFOBAR_NO_FILTERS")),c},com.zespri.awct.control.FacetFilter.prototype._getSelectedItemsText=function(a){var b=a.getSelectedItems().map(function(a){return a.getText()});return a._oSelectedKeys&&Object.getOwnPropertyNames(a._oSelectedKeys).forEach(function(c){-1===b.indexOf(a._oSelectedKeys[c])&&b.push(a._oSelectedKeys[c])}),b},com.zespri.awct.control.FacetFilter.prototype._addResetToSummary=function(a){1===a.getContent().length&&(a.addContent(new sap.m.ToolbarSpacer({width:""})),a.addContent(this._createResetButton()))},com.zespri.awct.control.FacetFilter.prototype._removeResetFromSummary=function(a){if(3===a.getContent().length){var b=a.removeAggregation("content",1);b.destroy();var c=a.removeAggregation("content",1);c.destroy()}},com.zespri.awct.control.FacetFilter.prototype._removeList=function(a){if(a){var b=this._buttons[a.getId()];b&&(this.removeAggregation("buttons",b),b.destroy());var c=this._removeFacetIcons[a.getId()];c&&(this.removeAggregation("removeIcons",c),c.destroy()),delete this._buttons[a.getId()],delete this._removeFacetIcons[a.getId()]}},com.zespri.awct.control.FacetFilter.prototype._getScrollingArrow=function(a){var b=null,c={src:"sap-icon://navigation-"+a+"-arrow"};if("left"===a){if(b=this.getAggregation("arrowLeft"),!b){c.id=this.getId()+"-arrowScrollLeft",b=sap.ui.core.IconPool.createControlByURI(c);for(var d=["sapMPointer","sapMFFArrowScroll","sapMFFArrowScrollLeft"],e=0;e<d.length;e++){b.addStyleClass(d[e]);var f=com.zespri.awct.util.I18NHelper.getText("TXT_FACET_FILTER_PREVIOUS_TOOLTIP");b.setTooltip(f)}this.setAggregation("arrowLeft",b)}}else if("right"===a){if(b=this.getAggregation("arrowRight"),!b){c.id=this.getId()+"-arrowScrollRight",b=sap.ui.core.IconPool.createControlByURI(c);for(var g=["sapMPointer","sapMFFArrowScroll","sapMFFArrowScrollRight"],h=0;h<g.length;h++){b.addStyleClass(g[h]);var i=com.zespri.awct.util.I18NHelper.getText("TXT_FACET_FILTER_NEXT_TOOLTIP");b.setTooltip(i)}this.setAggregation("arrowRight",b)}}else jQuery.sap.log.error("Scrolling arrow name "+a+" is not valid");return b},com.zespri.awct.control.FacetFilter.prototype._checkOverflow=function(){var a=this.getDomRef("head"),b=this.$(),c=!1;if(a&&a.scrollWidth>a.clientWidth&&(c=!0),b.toggleClass("sapMFFScrolling",c),b.toggleClass("sapMFFNoScrolling",!c),this._lastScrolling=c,a){var d=a.scrollLeft,e=!1,f=!1,g=a.scrollWidth,h=a.clientWidth;if(1===Math.abs(g-h)&&(g=h),this._bRtl){var i=jQuery(a);i.scrollLeftRTL()>0&&(f=!0),i.scrollRightRTL()>0&&(e=!0)}else d>0&&(e=!0),g>h&&g>d+h&&(f=!0);(f!==this._bPreviousScrollForward||e!==this._bPreviousScrollBack)&&(this._bPreviousScrollForward=f,this._bPreviousScrollBack=e,b.toggleClass("sapMFFNoScrollBack",!e),b.toggleClass("sapMFFNoScrollForward",!f))}},com.zespri.awct.control.FacetFilter.prototype.onclick=function(a){var b=a.target.id;if(b){var c=this.getId();a.preventDefault(),b===c+"-arrowScrollLeft"?this._scroll(-com.zespri.awct.control.FacetFilter.SCROLL_STEP,500):b===c+"-arrowScrollRight"&&this._scroll(com.zespri.awct.control.FacetFilter.SCROLL_STEP,500)}},com.zespri.awct.control.FacetFilter.prototype._scroll=function(a,b){var c=this.getDomRef("head"),d=c.scrollLeft;!com.zespri.awct.util.Constants.C_IS_BROWSER_IE&&this._bRtl&&(a=-a);var e=d+a;jQuery(c).stop(!0,!0).animate({scrollLeft:e},b)},com.zespri.awct.control.FacetFilter.prototype._enableTouchSupport=function(){var a=this,b=function(b){b.preventDefault(),a._iInertiaIntervalId&&window.clearInterval(a._iInertiaIntervalId),a.startScrollX=a.getDomRef("head").scrollLeft,a.startTouchX=b.touches[0].pageX,a._bTouchNotMoved=!0,a._lastMoveTime=(new Date).getTime()},c=function(b){var c=b.touches[0].pageX-a.startTouchX,d=a.getDomRef("head"),e=d.scrollLeft,f=a.startScrollX-c;d.scrollLeft=f,a._bTouchNotMoved=!1;var g=(new Date).getTime()-a._lastMoveTime;a._lastMoveTime=(new Date).getTime(),g>0&&(a._velocity=(f-e)/g),b.preventDefault()},d=function(b){if(a._bTouchNotMoved===!1){b.preventDefault();var c=a.getDomRef("head"),d=50,e=Math.abs(a._velocity/10);a._iInertiaIntervalId=window.setInterval(function(){a._velocity=.8*a._velocity;var b=a._velocity*d;c.scrollLeft=c.scrollLeft+b,Math.abs(a._velocity)<e&&(window.clearInterval(a._iInertiaIntervalId),a._iInertiaIntervalId=void 0)},d)}else a._bTouchNotMoved===!0&&(a.onclick(b),b.preventDefault());a._bTouchNotMoved=void 0,a._lastMoveTime=void 0};this.addEventDelegate({ontouchstart:b},this),this.addEventDelegate({ontouchend:d},this),this.addEventDelegate({ontouchmove:c},this)}}();
!function(){"use strict";jQuery.sap.declare("com.zespri.awct.Component"),jQuery.sap.require("com.zespri.awct.core.Router"),jQuery.sap.require("com.zespri.awct.util.Enums"),jQuery.sap.require("com.zespri.awct.util.I18NHelper"),jQuery.sap.require("com.zespri.awct.util.CommonFormatHelper"),jQuery.sap.require("com.zespri.awct.util.Constants"),jQuery.sap.require("com.zespri.awct.util.NotificationHelper"),jQuery.sap.require("sap.m.routing.RouteMatchedHandler"),sap.ui.core.UIComponent.extend("com.zespri.awct.Component",{metadata:{name:"ZESPRI Allocation Workbench & Collaboration Tool",version:"1.0",includes:[],dependencies:{libs:["sap.m","sap.ui.layout"],components:[]},config:{resourceBundle:"i18n/messageBundle.properties",serviceConfig:{name:"AWCT",serviceUrl:"/sap/opu/odata/sap/Z_AWCT_SRV"},rootContentContainer:"unifiedShellNavContainer",routing:{config:{viewType:"XML",viewPath:"com.zespri.awct",targetParent:"componentView",targetControl:"unifiedShellNavContainer",targetAggregation:"pages",clearTarget:!1,transition:"slide"},routes:[{pattern:"Allocation/EditOrderAllocation/{contextPath}",name:"Allocation/EditOrderAllocation",view:"alloc.view.EditOrderAllocation"},{pattern:"Collaboration/SupplierOrders",name:"Collaboration/SupplierOrders",view:"collab.view.SupplierOrders"},{pattern:"Allocation/DeliverySwapListing",name:"Allocation/DeliverySwapListing",view:"alloc.view.DeliverySwapListing"},{pattern:"Allocation/DeliverySwapCreate",name:"Allocation/DeliverySwapCreate",view:"alloc.view.DeliverySwapCreate"},{pattern:"Allocation/DeliverySwapDetails/{contextPath}",name:"Allocation/DeliverySwapDetails",view:"alloc.view.DeliverySwapDetails"},{pattern:"Allocation/DeliveryWorkList",name:"Allocation/DeliveryWorkList",view:"alloc.view.DeliveryWorkList",transition:"show",viewLevel:0,subroutes:{"Allocation/DeliveryWorkList/Detail":{pattern:"Allocation/DeliveryWorkList/{contextPath}",name:"Allocation/DeliveryWorkList/Detail",view:"alloc.view.DetailDeliveryWorkList",targetParent:null,targetControl:"idSplitDeliveyLine",targetAggregation:"detailPages",transition:"show",viewLevel:1},"Allocation/DeliveryWorkList/NoResults":{pattern:"Allocation/DeliveryWorkList/NoResults/{viewTitle}/{infoText}/{isEmptyView}",name:"Allocation/DeliveryWorkList/NoResults",view:"alloc.view.Empty",targetParent:null,targetControl:"idSplitDeliveyLine",targetAggregation:"detailPages",transition:"show",viewLevel:1}}},{pattern:"Tools/OData",name:"Tools/OData",view:"tools.odata.view.ODataRequestCheck"},{pattern:"Collaboration/SearchForm",name:"Collaboration/SearchForm",view:"collab.view.SearchForm"},{pattern:"Collaboration/TrackOrders",name:"Collaboration/TrackOrders",view:"collab.view.TrackOrders"},{pattern:"Collaboration/TrackOrdersSearchForm",name:"Collaboration/TrackOrdersSearchForm",view:"collab.view.TrackOrdersSearchForm"},{pattern:"Collaboration/TradeOpportunities",name:"Collaboration/TradeOpportunities",view:"collab.view.TradeOpportunities"},{pattern:"Collaboration/TradeOpportunitiesDetails/{contextPath}",name:"Collaboration/TradeOpportunitiesDetails",view:"collab.view.TradeOpportunitiesDetails"},{pattern:"Administration/MaintainLibraryText",name:"Administration/MaintainLibraryText",view:"admin.view.MaintainLibraryText"},{pattern:"Administration/MaintainLibraryText/:viewMode:/:contextPath:",name:"Administration/MaintainLibraryTextDetail",view:"admin.view.LibraryTextDetails"},{pattern:"Administration/TimeBasedRateMaintenance",name:"Administration/TimeBasedRateMaintenance",view:"admin.view.TimeBasedRateMaintenance"},{pattern:"Administration/TimeBasedRateMaintenance/:viewMode:/:contextPath:",name:"Administration/TimeRateDetail",view:"admin.view.TimeBasedRateDetail"},{pattern:"Administration/ExceptionRateMaintenance",name:"Administration/ExceptionRateMaintenance",view:"admin.view.ExceptionRateMaintenance"},{pattern:"Administration/ExceptionRateMaintenance/:viewMode:/:contextPath:",name:"Administration/ExceptionRateDetail",view:"admin.view.ExceptionRateDetail"},{pattern:"Administration/ScheduleRates",name:"Administration/ScheduleRates",view:"admin.view.ScheduleRates"},{pattern:"Administration/ScheduleRates/{contextPath}",name:"Administration/ScheduleRatesDetail",view:"admin.view.ScheduleRatesDetail"},{pattern:"Collaboration/PrintOrders",name:"Collaboration/PrintOrders",view:"collab.view.PrintOrders"},{pattern:"Allocation/SupplyPlan/:DeliveryLineID:",name:"Allocation/SupplyPlan",view:"alloc.view.SupplyPlan"},{pattern:"Reports/GenerateReports",name:"Reports/GenerateReports",view:"report.view.GenerateReports"},{pattern:":all*:",view:"shell.view.Dashboard",name:"/"}]}}},oRouteHandler:null,oView:null,mApplicationParameters:null,init:function(){this._bUserAuthorized=!1;var a=this;sap.ui.core.UIComponent.prototype.init.apply(this,arguments);var b=jQuery.sap.getModulePath("com.zespri.awct"),c=this.getMetadata().getConfig(),d=new sap.ui.model.resource.ResourceModel({bundleUrl:[b+"/"+c.resourceBundle]});this.setModel(d,"i18n");var e=new sap.ui.model.odata.ODataModel(c.serviceConfig.serviceUrl,!0);e.setDefaultCountMode(sap.ui.model.odata.CountMode.Inline),e.setSizeLimit(com.zespri.awct.util.Constants.C_ODATA_MODEL_SIZE_LIMIT),this.setModel(e),this._setCurrentUserModel();var f=this.getRouter();this.oRouteMatchedHandler=new sap.m.routing.RouteMatchedHandler(f),window.setTimeout(function(){a._bUserAuthorized&&(f.initialize(),a._checkBrowserSupport())},0)},_setCurrentUserModel:function(){var a=this,b=null,c=[];this.getModel().refreshSecurityToken(),this.getModel().read("/GetApplicationParameters",{success:function(d){var e=d.GetApplicationParameters;a.mApplicationParameters=e;var f=com.zespri.awct.util.CommonFormatHelper.formatUserName(e.FirstName,e.LastName);b=e.UserID;var g="/UserSet('"+b+"')";a.getModel().read(g,{urlParameters:{$expand:"AuthorizationSet,SupplierSet"},success:function(d){c=d.SupplierSet.results;var e={UserID:b,UserName:f,SupplierSet:c},g={};g=d.AuthorizationSet.results,e.AuthorizationSet=g;var h=new sap.ui.model.json.JSONModel(e);a.setModel(h,"currentUserDetails"),sap.ui.getCore().byId("componentView").setBusy(!1),a._bUserAuthorized=!0},error:function(b){window.setTimeout(function(){com.zespri.awct.util.NotificationHelper.handleErrorMessage(b)},0),sap.ui.getCore().byId("componentView").destroy(),a._bUserAuthorized=!1},async:!1})},error:function(b){window.setTimeout(function(){com.zespri.awct.util.NotificationHelper.handleErrorMessage(b)},0),sap.ui.getCore().byId("componentView").destroy(),a._bUserAuthorized=!1},async:!1})},createContent:function(){var a={oComponent:this};return this.oView=sap.ui.view("componentView",{viewName:"com.zespri.awct.shell.view.AppContainer",type:sap.ui.core.mvc.ViewType.XML,viewData:a,busyIndicatorDelay:0,busy:!0}),this.oView},isCurrentViewDirty:function(){var a=this.getMetadata().getConfig().routing.config.targetParent,b=this.getMetadata().getConfig().routing.config.targetControl,c=sap.ui.getCore().byId(a).byId(b),d=c.getCurrentPage();return d?d.getController().getHasUnsavedChanges():!1},getRouter:function(){if(!this._oRouter){var a=this.getMetadata().getConfig().routing.routes,b=this.getMetadata().getConfig().routing.config,c=this;this._oRouter=new com.zespri.awct.core.Router(a,b,c)}return this._oRouter},getApplicationParameters:function(){return this.mApplicationParameters},destroy:function(){this.oRouteMatchedHandler&&this.oRouteMatchedHandler.destroy(),this.oView&&this.oView.destroy(),sap.ui.core.UIComponent.destroy.apply(this,arguments)},_checkBrowserSupport:function(){var a=sap.ui.Device.browser,b=a.name,c=a.version,d=!1;if("ie"===b&&c>=9||"cr"===b||"ff"===b&&c>=32?d=!0:"sf"===b?a.mobile&&c>=5.1?d=!0:!a.mobile&&c>=7.1&&(d=!0):d=!1,!d){var e=com.zespri.awct.util.I18NHelper.getText("TXT_CURRENT_BROWSER_NOT_SUPPORTED_WARNING_TEXT");com.zespri.awct.util.NotificationHelper.showErrorToast(e)}}})}();
/*----------------------------------------------------------------------* 
 * Copyright  (c) 2014 SAP SE. All rights reserved	
 * Author       : SAP Custom Development 
 *----------------------------------------------------------------------*/ 
	!function(){"use strict";jQuery.sap.require({modName:"com.zespri.awct.core.Controller",type:"controller"}),jQuery.sap.require("com.zespri.awct.util.CommonFormatHelper"),jQuery.sap.require("com.zespri.awct.util.I18NHelper"),jQuery.sap.require("com.zespri.awct.util.LocaleFormatHelper"),jQuery.sap.require("com.zespri.awct.util.NotificationHelper"),jQuery.sap.require("sap.ui.core.format.NumberFormat"),jQuery.sap.require("com.zespri.awct.util.ModelHelper"),com.zespri.awct.core.Controller.extend("com.zespri.awct.collab.view.DeliverySwapDetails",{_oDeliverySwapListingContext:null,_DeliverySwapRecordType:{DeliveryLine:"D",SupplierOrderLine:"A"},onInit:function(){var a=this,b=this.getView();this.getRouter().attachRoutePatternMatched(function(c){if("Collaboration/DeliverySwapDetails"===c.getParameter("name")){var d=c.getParameter("arguments").contextPath;this._oDeliverySwapListingContext=new sap.ui.model.Context(b.getModel(),"/"+d);var e=this._oDeliverySwapListingContext.getProperty("DeliverySwapID"),f=!1;if(e)this._bindDeliverySwapLineItems(d,f);else{f=!0;var g=function(b){a._oDeliverySwapListingContext=new sap.ui.model.Context(b,"/result"),a._bindDeliverySwapLineItems(d,f),a.getView().setBusy(!1)},h=function(){a.getView().setBusy(!1);var b=com.zespri.awct.util.I18NHelper.getText("TXT_COLLABORATION_DELIVERYSWAP_DETAILS_ERROR_MESSAGE");com.zespri.awct.util.NotificationHelper.showErrorDialog(b)};this.getView().setBusy(!0),com.zespri.awct.util.ModelHelper.getJSONModelForRead(d,{urlParameters:{$expand:"DeliverySwapLineSet"}},g,h)}}},this)},_bindDeliverySwapLineItems:function(a,b){var c=this.byId("deliverySwapDetailsTable"),d="";this.getView().setModel(this._oDeliverySwapListingContext.getModel()).setBindingContext(this._oDeliverySwapListingContext),d=b?"DeliverySwapLineSet/results":"/"+a+"/DeliverySwapLineSet",c.bindAggregation("items",{path:d,template:c.getBindingInfo("items")?c.getBindingInfo("items").template:c.getItems()[0].clone()})},formatIsSupplierLine:function(a,b){return b===this._DeliverySwapRecordType.DeliveryLine?com.zespri.awct.util.I18NHelper.getText("TXT_COLLABORATION_DELIVERYSWAP_COLUMN_SUPPLIER_ID_ALL"):a},handleViewSourceBatchCharacteristicsOpen:function(a){var b=a.getSource().getBindingContext().getProperty("SourceDeliveryLineNumber");this._OpenViewBatchCharacteristicsDialog(b)},handleViewTargetBatchCharacteristicsOpen:function(a){var b=a.getSource().getBindingContext().getProperty("TargetDeliveryLineNumber");this._OpenViewBatchCharacteristicsDialog(b)},_OpenViewBatchCharacteristicsDialog:function(a){var b=this,c=function(a){b._oViewBatchCharacteristicsDialog.setModel(a);var c=a.getData().results.length;sap.ui.core.Fragment.byId("viewBatchCharacteristicsFragment","viewBatchCharacteristicsTableHeader").setText(com.zespri.awct.util.I18NHelper.getText("TXT_COLLABORATION_VIEWBATCHCHARACTERISTICS_TABLE_TITLE",[c])),b._oViewBatchCharacteristicsDialog.setBusy(!1)},d=function(){var a=com.zespri.awct.util.I18NHelper.getText("TXT_COLLABORATION_DELIVERYSWAP_DETAILS_ERROR_MESSAGE");com.zespri.awct.util.NotificationHelper.showErrorDialog(a),b._oViewBatchCharacteristicsDialog.setBusy(!1)};b._oViewBatchCharacteristicsDialog||(b._oViewBatchCharacteristicsDialog=new sap.ui.xmlfragment("viewBatchCharacteristicsFragment","com.zespri.awct.collab.fragment.ViewBatchCharacteristics",this),b._oViewBatchCharacteristicsDialog.setModel(b.getView().getModel("i18n"),"i18n")),com.zespri.awct.util.ModelHelper.getJSONModelForRead("/BatchCharacteristicsSet",{urlParameters:{$filter:"DeliveryLineNumber eq '"+a+"'",$expand:"BatchCharacteristicsValueSet"}},c,d),b._oViewBatchCharacteristicsDialog.setBusy(!0),b._oViewBatchCharacteristicsDialog.open()},handleViewBatchCharacteristicsOKPress:function(){this._oViewBatchCharacteristicsDialog.close()},formatBatchCharacteristicsValuesText:function(a){var b=function(a){return a.Value};return a.results.map(b).join(", ")},formatExcludeIncludeText:function(a){return com.zespri.awct.util.I18NHelper.getText(a?"TXT_COLLABORATION_VIEWBATCHCHARACTERISTICS_EXCLUDE":"TXT_COLLABORATION_VIEWBATCHCHARACTERISTICS_INCLUDE")}})}();